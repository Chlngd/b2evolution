/* This includes 23 files: build/evo_generic.bmin.js, functions.js, ajax.js, communication.js, form_extensions.js, extracats.js, dynamic_select.js, backoffice.js, blog_widgets.js,src/evo_modal_window.js, src/evo_images.js, src/evo_user_crop.js, src/evo_user_report.js, src/evo_user_deldata.js, src/evo_user_org.js, src/evo_automation.js, src/evo_user_tags.js, src/evo_user_status.js, src/evo_user_groups.js, src/evo_rest_api.js, src/evo_links.js, src/evo_forms.js, src/evo_input_counter.js */

function evo_prevent_key_enter(e){jQuery(e).keypress(function(e){if(13==e.keyCode)return!1})}function link_attachment_window(e,t,n,r,o,i){openModalWindow('<span class="loader_img loader_user_report absolute_center" title="'+evo_link_attachment_window_config.loader_title+'"></span>',"90%","80%",!0,evo_link_attachment_window_config.window_title,"",!0);var a={action:"link_attachment",link_owner_type:e,link_owner_ID:t,crumb_link:evo_link_attachment_window_config.crumb_link,root:void 0===n?"":n,path:void 0===r?"":r,fm_highlight:void 0===o?"":o,prefix:void 0===i?"":i};return jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:a,success:function(e){openModalWindow(e,"90%","80%",!0,evo_link_attachment_window_config.window_title,"")}}),!1}function pop_up_window(e,t,n,r,o){return void 0===n&&(n=750),void 0===r&&(r=550),void 0===o&&(o="scrollbars=yes, status=yes, resizable=yes, menubar=yes"),o="width="+n+", height="+r+", left="+(screen.width-n)/2+", top="+(screen.height-r)/2+", "+o,opened=window.open(e,t,o),opened.focus(),"undefined"==typeof openedWindows?openedWindows=new Array(opened):openedWindows.push(opened),!1}function textarea_replace_selection(e,t,n){textarea_wrap_selection(e,t,"",1,n)}function textarea_wrap_selection(e,t,n,r,o){var i={element:e,before:t,after:n,replace:r,target_document:o=o||document};if(!b2evo_Callbacks.trigger_callback("wrap_selection_for_"+e.id,i)){if(window.opener&&void 0!==window.opener)try{if(window.opener.b2evo_Callbacks&&void 0!==window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback("wrap_selection_for_"+e.id,i))return}catch(e){}if(!(window.parent&&void 0!==window.parent&&window.parent.b2evo_Callbacks&&void 0!==window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback("wrap_selection_for_"+e.id,i)))if(o.selection)e.focus(),sel=o.selection.createRange(),sel.text=r?t+n:t+sel.text+n,e.focus();else if(e.selectionStart||"0"==e.selectionStart){var a,s,_,d=e.selectionStart,l=e.selectionEnd;"textarea"==e.type&&void 0!==e.scrollTop&&(s=e.scrollTop,_=e.scrollLeft),a=r?(e.value=e.value.substring(0,d)+t+n+e.value.substring(l,e.value.length),d+t.length+n.length):(e.value=e.value.substring(0,d)+t+e.value.substring(d,l)+n+e.value.substring(l,e.value.length),l+t.length+n.length),void 0!==s&&(e.scrollTop=s,e.scrollLeft=_),e.focus(),e.selectionStart=a,e.selectionEnd=a}else e.value+=t+n,e.focus()}}function textarea_str_replace(e,t,n,r){var o={element:e,search:t,replace:n,target_document:r=r||document};if(!b2evo_Callbacks.trigger_callback("str_replace_for_"+e.id,o)){if(window.opener&&void 0!==window.opener)try{if(window.opener.b2evo_Callbacks&&void 0!==window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback("str_replace_for_"+e.id,o))return}catch(e){}window.parent&&void 0!==window.parent&&window.parent.b2evo_Callbacks&&void 0!==window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback("str_replace_for_"+e.id,o)||(e.value=e.value.replace(t,n),e.focus())}}function toggle_filter_area(e,t){var n=jQuery("#clickdiv_"+e),r=jQuery("#clickimg_"+e);if(0==n.length||0==r.length)return alert("ID "+e+" not found!"),!1;if(r.hasClass("fa")||r.hasClass("glyphicon")){if(""!=r.data("toggle")&&null!=r.data("toggle")){var o=r.hasClass("fa")?"fa":"glyphicon";null==r.data("toggle-orig-class")&&r.data("toggle-orig-class",r.attr("class").replace(new RegExp("^"+o+" (.+)$","g"),"$1")),r.hasClass(r.data("toggle-orig-class"))?r.removeClass(r.data("toggle-orig-class")).addClass(o+"-"+r.data("toggle")):r.removeClass(o+"-"+r.data("toggle")).addClass(r.data("toggle-orig-class"))}}else{var i=r.css("background-position").match(/-*\d+/g);r.css("background-position",parseInt(i[0])+(n.is(":hidden")?-16:16)+"px "+parseInt(i[1])+"px")}var a=void 0===t?n.is(":hidden")?"expand":"collapse":t;return"collapse"==a?n.slideUp(500):"expand"==a&&n.slideDown(500),void 0===t&&"expand"==a&&jQuery("#clickdiv_"+e).closest(".filters").find("[id^=clickdiv_]").each(function(){jQuery(this).is(":visible")&&jQuery(this).attr("id")!="clickdiv_"+e&&toggle_filter_area(jQuery(this).attr("id").substr(9),"collapse")}),!1}function b2evo_Callbacks(){this.eventHandlers=new Array}void 0===evoFadeBg&&(evoFadeBg=function evoFadeBg(selector,bgs,options){var origBg=jQuery(selector).css("backgroundColor"),speed=options&&options.speed||'"slow"',toEval="jQuery(selector).animate({ backgroundColor: ";for(e in bgs)"string"==typeof bgs[e]&&(toEval+='"'+bgs[e]+'"}, '+speed+" ).animate({ backgroundColor: ");toEval+="origBg }, "+speed+', "", function(){jQuery( this ).css( "backgroundColor", "" );});',eval(toEval)}),void 0===evoFadeSuccess&&(evoFadeSuccess=function(e){evoFadeBg(e,new Array("#ddff00","#bbff00"))}),jQuery(document).ready(function(){if("undefined"!=typeof evo_init_datepicker&&jQuery(evo_init_datepicker.selector).datepicker(evo_init_datepicker.config),"undefined"!=typeof evo_link_position_config&&(window.displayInlineReminder=evo_link_position_config.display_inline_reminder,window.deferInlineReminder=evo_link_position_config.defer_inline_reminder,jQuery(document).on("change",evo_link_position_config.selector,{url:evo_link_position_config.url,crumb:evo_link_position_config.crumb},function(e){"inline"==this.value&&window.displayInlineReminder&&!window.deferInlineReminder&&(alert(evo_link_position_config.alert_msg),window.displayInlineReminder=!1),evo_link_change_position(this,e.data.url,e.data.crumb)})),"undefined"!=typeof evo_itemform_renderers__click&&jQuery("#itemform_renderers .dropdown-menu").on("click",function(e){e.stopPropagation()}),"undefined"!=typeof evo_commentform_renderers__click&&jQuery("#commentform_renderers .dropdown-menu").on("click",function(e){e.stopPropagation()}),"undefined"!=typeof evo_disp_download_delay_config&&(window.b2evo_download_timer=evo_disp_download_delay_config,window.downloadInterval=setInterval(function(){jQuery("#download_timer").html(window.b2evo_download_timer),0==window.b2evo_download_timer&&(clearInterval(window.downloadInterval),jQuery("#download_help_url").show()),window.b2evo_download_timer--},1e3),jQuery("#download_timer_js").show()),"undefined"!=typeof evo_skin_bootstrap_forum__quote_button_click&&jQuery(".quote_button").click(function(){var e=jQuery("form[id^=evo_comment_form_id_]");return 0==e.length||(e.attr("action",jQuery(this).attr("href")),e.submit(),!1)}),"undefined"!=typeof evo_ajax_form_config)for(var t=Object.values(evo_ajax_form_config),n=0;n<t.length;n++)!function(){var o=t[n];window["ajax_form_offset_"+o.form_number]=jQuery("#ajax_form_number_"+o.form_number).offset().top,window["request_sent_"+o.form_number]=!1,window["ajax_form_loading_number_"+o.form_number]=0;var i="get_form_"+o.form_number;window[i]=function(){var r="#ajax_form_number_"+o.form_number;window["ajax_form_loading_number_"+o.form_number]++,jQuery.ajax({url:htsrv_url+"anon_async.php",type:"POST",data:o.json_params,success:function(e){jQuery(r).html(ajax_debug_clear(e))},error:function(e,t,n){jQuery(".loader_ajax_form",r).after('<div class="red center">'+n+": "+e.responseText+"</div>"),window["ajax_form_loading_number_"+o.form_number]<3&&setTimeout(function(){jQuery(".loader_ajax_form",r).next().remove(),window[i]()},1e3)}})};var e="check_and_show_"+o.form_number;window[e]=function(e){if(!window["request_sent_"+o.form_number]){var t=null!=typeof e&&e;(t=t||jQuery(window).scrollTop()>=window["ajax_form_offset_"+o.form_number]-jQuery(window).height()-20)&&(window["request_sent_"+o.form_number]=!0,window[i]())}},jQuery(window).scroll(function(){window[e]()}),jQuery(window).resize(function(){window[e]()}),window[e](o.load_ajax_form_on_page_load)}();if("undefined"!=typeof evo_thread_form_config&&(window.check_multiple_recipients=function(){1<jQuery('input[name="thrd_recipients_array[login][]"]').length?jQuery("#multiple_recipients").show():jQuery("#multiple_recipients").hide()},window.check_form_thread=function(){return""==jQuery("input#token-input-thrd_recipients").val()||(alert(evo_thread_form_config.missing_username_msg),jQuery("input#token-input-thrd_recipients").focus(),!1)},evo_thread_form_config.token_input_config.tokenFormatter=function(e){return"<li>"+e[evo_thread_form_config.username_display]+'<input type="hidden" name="thrd_recipients_array[id][]" value="'+e.id+'" /><input type="hidden" name="thrd_recipients_array[login][]" value="'+e.login+'" /></li>'},evo_thread_form_config.token_input_config.resultsFormatter=function(e){var t=e.login;return null!=e.fullname&&void 0!==e.fullname&&(t+="<br />"+e.fullname),"<li>"+e.avatar+"<div>"+t+"</div><span></span></li>"},evo_thread_form_config.token_input_config.onAdd=function(){window.check_multiple_recipients()},evo_thread_form_config.token_input_config.onDelete=function(){window.check_multiple_recipients()},evo_thread_form_config.token_input_config.onReady=function(){evo_thread_form_config.thrd_recipients_has_error&&jQuery(".token-input-list-facebook").addClass("token-input-list-error"),jQuery("#thrd_recipients").removeAttr("required")},jQuery("#thrd_recipients").tokenInput(restapi_url+"users/recipients",evo_thread_form_config.token_input_config),window.check_multiple_recipients()),"undefined"!=typeof evo_comment_form_preview_button_config&&jQuery("input[type=submit].preview.btn-info").val(evo_comment_form_preview_button_config.button_value),"undefined"!=typeof evo_user_func__callback_filter_userlist&&(jQuery("#country").change(function(){jQuery(this),jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_regions_option_list&ctry_id="+jQuery(this).val(),success:function(e){jQuery("#region").html(ajax_debug_clear(e)),1<jQuery("#region option").length?jQuery("#region_filter").show():jQuery("#region_filter").hide(),window.load_subregions(0)}})}),jQuery("#region").change(function(){window.load_subregions(jQuery(this).val())}),jQuery("#subregion").change(function(){window.load_cities(jQuery("#country").val(),jQuery("#region").val(),jQuery(this).val())}),window.load_subregions=function(t){jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_subregions_option_list&rgn_id="+t,success:function(e){jQuery("#subregion").html(ajax_debug_clear(e)),1<jQuery("#subregion option").length?jQuery("#subregion_filter").show():jQuery("#subregion_filter").hide(),load_cities(jQuery("#country").val(),t,0)}})},window.load_cities=function(e,t,n){void 0===e&&(e=0),jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_cities_option_list&ctry_id="+e+"&rgn_id="+t+"&subrg_id="+n,success:function(e){jQuery("#city").html(ajax_debug_clear(e)),1<jQuery("#city option").length?jQuery("#city_filter").show():jQuery("#city_filter").hide()}})}),"undefined"!=typeof coll_activity_stats_widget_config&&(window.coll_activity_stats_widget_resize_timer,window.resize_coll_activity_stat_widget=function(){var e=[],t=[],n=[],r=coll_activity_stats_widget_config.time_period;if(null==plot){plot=jQuery("#canvasbarschart").data("plot"),n=plot.axes.xaxis.ticks.slice(0);for(var o=0;o<plot.series.length;o++)e.push(plot.series[o].data.slice(0));if(7==e[0].length)t=e;else for(o=0;o<e.length;o++){for(var i=[],a=7,s=1;0<a;a--,s++)i.unshift([a,e[o][e[o].length-s][1]]);t.push(i)}}if(jQuery("#canvasbarschart").width()<650){if("last_week"!=r){for(o=0;o<plot.series.length;o++)plot.series[o].data=t[o];plot.axes.xaxis.ticks=n.slice(-7),r="last_week"}}else if("last_month"!=r){for(o=0;o<plot.series.length;o++)plot.series[o].data=e[o];plot.axes.xaxis.ticks=n,r="last_month"}plot.replot({resetAxes:!0})},jQuery(window).resize(function(){clearTimeout(coll_activity_stats_widget_resize_timer),coll_activity_stats_widget_resize_timer=setTimeout(resize_coll_activity_stat_widget,100)})),"undefined"!=typeof evo_item_tags_widget_config){window.add_quick_tag=function(e,t){var n=jQuery(t).text();jQuery("#item_tags_"+e).tokenInput("add",{id:n,name:n})},window.init_edit_item_tags_icon=function(e,t){jQuery("#evo_widget_item_tags_edit_icon_"+t).click(function(){return jQuery("#evo_widget_item_tags_edit_form_"+t).show(),jQuery("input#token-input-"+e,"#evo_widget_item_tags_edit_form_"+t).focus(),jQuery("#evo_widget_item_tags_list_"+t).hide(),!1})};var e=Object.values(evo_item_tags_widget_config);for(n=0;n<e.length;n++)r=e[n],window.init_edit_item_tags_icon(r.input_ID,r.widget_ID);delete e}var r;if("undefined"!=typeof evo_workflow_properties_widget_config&&jQuery("[id^=evo_widget_item_workflow_properties_] a").click(function(){var e=jQuery(this).closest("[id^=evo_widget_item_workflow_properties_]");return e.next("[id^=evo_widget_item_workflow_form_]").show(),e.hide(),!1}),"undefined"!=typeof evo_display_attachments_fieldset_config&&function(){for(var e=Object.values(evo_display_attachments_fieldset_config),t=0;t<e.length;t++)jQuery("#"+e[t].fieldset_prefix+e[t].form_id).show()}(),"undefined"!=typeof evo_contact_list_view_config&&(window.get_selected_users=function(){var e="";return jQuery("input[name^=contacts]").each(function(){jQuery(this).is(":checked")&&(e+=jQuery(this).val()+",")}),0<e.length&&(e=e.substr(0,e.length-1)),e},jQuery("#send_selected_recipients").click(function(){var e="",t=window.get_selected_users();return 0<t.length&&(e="&recipients="+t),location.href=evo_contact_list_view_config.recipients_link_url+e,!1}),jQuery("#add_group_contacts").submit(function(){jQuery("input[name=users]").val(window.get_selected_users())})),"undefined"!=typeof evo_user_identity_form_config&&function(){var o=evo_user_identity_form_config;window.replace_form_params=function(e,t){return t=void 0===t?"":' id="'+t+'"',e.replace("#fieldstart#",o.fieldstart).replace("#fieldend#",o.fieldend).replace("#labelclass#",o.labelclass).replace("#labelstart#",o.labelstart).replace("#labelend#",o.labelend).replace("#inputstart#",o.inputstart).replace("#inputend#",o.inputend)},jQuery("#button_add_field").click(function(){var e=jQuery(this).prev().find("option:selected").val();if(""==e)return window.field_type_error(o.msg_select_field_type),!1;window.field_type_error_clear();var t=o.params;return jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_user_new_field&user_id="+o.user_ID+"&field_id="+e+t,success:function(e){if("[0]"==(e=ajax_debug_clear(e)))window.field_type_error(o.msg_field_already_added);else{if(e=window.replace_form_params(e),0==parseInt(e.replace(/^\[(\d+)\](.*)/,"$1"))){var t=parseInt(e.replace(/(.*)fieldset id="ffield_uf_add_(\d+)_(.*)/,"$2"));if(jQuery("#new_field_type option[value="+t+"]").remove(),0<jQuery("[id^=uf_new_"+t+"], [id^=uf_add_"+t+"]").length)return window.field_type_error(o.msg_field_already_added),!1}jQuery("#ffield_new_field_type").before(e.replace(/^\[\d+\](.*)/,"$1")),jQuery("span[rel^=add_ufdf_]").show(),bind_autocomplete(jQuery("#ffield_new_field_type").prev().prev().find("input[id^=uf_add_][autocomplete=on]"))}}}),!1}),jQuery(document).on("focus","[rel^=ufdf_]",function(){var e=parseInt(jQuery(this).attr("rel").replace(/^ufdf_(\d+)$/,"$1"));0<e&&(jQuery("#new_field_type").val(e),window.field_type_error_clear())}),jQuery("#new_field_type").change(function(){window.field_type_error_clear()}),window.field_type_error=function(e){jQuery("select#new_field_type").addClass("field_error");var t=jQuery("select#new_field_type").next().find("span.field_error");0<t.length?t.html(e):jQuery("select#new_field_type").next().append('<span class="field_error">'+e+"</span>")},window.field_type_error_clear=function(){jQuery("select#new_field_type").removeClass("field_error").next().find("span.field_error").remove()},jQuery("span[rel^=add_ufdf_]").show(),jQuery(document).on("click","span[rel^=add_ufdf_]",function(){var r=jQuery(this),e=r.attr("rel").replace(/^add_ufdf_(\d+)$/,"$1"),t=o.params;jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_user_new_field&user_id="+o.user_ID+"&field_id="+e+t,success:function(e){if("[0]"==(e=ajax_debug_clear(e)))window.field_type_error(o.msg_field_already_added);else{if(e=window.replace_form_params(e),0==parseInt(e.replace(/^\[(\d+)\](.*)/,"$1")))return window.field_type_error(o.msg_field_already_added),!1;var t=r.parent().parent().parent();t.after(e.replace(/^\[\d+\](.*)/,"$1")).next().find("span[rel^=add_ufdf_]").show();var n=t.next().find("input[id^=uf_add_]");"on"==n.attr("autocomplete")&&bind_autocomplete(n),n.focus()}}})}),jQuery(document).on("mouseover","span[rel^=add_ufdf_]",function(){jQuery(this).parent().prev().focus(),jQuery(this).css("z-index",jQuery(this).parent().prev().css("z-index"))}),jQuery(document).on("mouseout","span[rel^=add_ufdf_]",function(){var e=jQuery(this).parent().prev();if(e.is(":focus"))return!1;e.blur()});var n='[id^="ffield_organizations_"]',r=o.max_organizations,i=0;jQuery(document).on("click","span.add_org",function(){var t=jQuery(this),e=o.params;e+="undefined"!=typeof remove_obj_after_org_adding?"&first_org=1":"",jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_user_new_org"+e,success:function(e){e=window.replace_form_params(ajax_debug_clear(e),"ffield_organizations_"+i),t.closest(n).after(e),"undefined"!=typeof remove_obj_after_org_adding&&(remove_obj_after_org_adding.remove(),delete remove_obj_after_org_adding),jQuery(n).length>=r&&jQuery("span.add_org").hide(),1<jQuery(n).length?jQuery("span.remove_org").show():jQuery("span.remove_org").hide(),i++}})}),jQuery(document).on("click","span.remove_org",function(){1<jQuery(n).length?jQuery(this).closest(n).remove():(remove_obj_after_org_adding=jQuery(this).closest(n),jQuery(this).parent().find("span.add_org").click()),jQuery(n).length<r&&jQuery("span.add_org").show(),0<jQuery(n).length?jQuery("span.remove_org").show():jQuery("span.remove_org").hide()}),window.bind_autocomplete=function(e){0<e.length&&e.autocomplete({source:function(e,t){jQuery.getJSON(htsrv_url+"anon_async.php?action=get_user_field_autocomplete",{term:e.term,attr_id:this.element[0].getAttribute("id")},t)}})},bind_autocomplete(jQuery("input[id^=uf_][autocomplete=on]"))}(),"undefined"!=typeof evo_user_organization_config&&jQuery(document).on("click","span[rel^=org_status_]",function(){var t=jQuery(this),e=evo_user_organization_config.params;jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=change_user_org_status&status="+t.attr("rel")+"&crumb_userorg="+evo_user_organization_config.crumb_userorg+e,success:function(e){t.after(ajax_debug_clear(e)).remove()}})}),"undefined"!=typeof evo_item_type_change_buttons_config&&jQuery("button[data-item-type]").on("click",function(){jQuery("[required]").removeAttr("required"),jQuery("input[name=item_typ_ID]").val(jQuery(this).data("item-type")),jQuery(this).closest("form").append('<input type="hidden" name="action" value="'+evo_item_type_change_buttons_config.action+'">').submit()}),"undefined"!=typeof evo_status_dropdown_button_config){var o=Object.values(evo_status_dropdown_button_config);for(n=0;n<o.length;n++)!function(){var _=o[n];jQuery("."+_.type+"_status_dropdown li a").click(function(){var e=_.tooltip_titles_js_array,t=jQuery(this).parent(),n=t.attr("rel"),r=t.parent().parent(),o=r.parent().parent(),i=r.find("button"),a=i.parent().find("button:first"),s=o.find('input[type="submit"]:not(.quick-publish)').add(i);return"published"==n?o.find(".quick-publish").hide():o.find(".quick-publish").show(),s.each(function(){jQuery(this).attr("class",jQuery(this).attr("class").replace(/btn-status-[^\s]+/,"btn-status-"+n))}),a.find("span:first").html(t.find("span:last").html()),jQuery("input[type=hidden][name="+_.type+"_status]").val(n),r.removeClass("open"),"submit"==a.attr("type")&&a.click(),r.tooltip("hide").attr("data-original-title",e[n]).tooltip("show"),!1})}()}if("undefined"!=typeof evo_init_onchange_newcat&&jQuery("#new_category_name").keypress(function(){var e=jQuery("#sel_maincat_new");e.attr("checked")||(e.attr("checked",!0),jQuery("#sel_extracat_new").attr("checked",!0))}),"undefined"!=typeof evo_autocomplete_tags_config){window.init_autocomplete_tags=function(t,n){if(!n&&window.evo_autocomplete_input_tag_configs[t]&&(n=window.evo_autocomplete_input_tag_configs[t]),n){var e=jQuery(t).val(),r=new Array;if(e&&0<e.length){for(var o in e=e.split(","))r.push({id:e[o].trim(),name:e[o].trim()});n.token_input_params.prePopulate=r}n.update_by_ajax&&(n.token_input_params.onAdd=function(e){n.use_quick_tags&&window.evo_update_item_quick_tags(e),window.evo_update_item_tags_by_ajax(n.item_ID,t,e,"add")},n.token_input_params.onDelete=function(e){window.evo_update_item_tags_by_ajax(n.item_ID,t,e,"delete")}),jQuery(t).tokenInput(restapi_url+"tags",n.token_input_params)}},window.evo_update_item_quick_tags=function(e){var t=e.name.trim(),n=jQuery.cookie("quick_item_tags"),r=(n=null==n||0==n.length?[]:n.split(",")).indexOf(t);-1===r||n.splice(r,1),n.push(t),n=n.splice(-5),jQuery.cookie("quick_item_tags",n.join(","),{domain:evo_autocomplete_tags_config.cookie_domain,path:evo_autocomplete_tags_config.cookie_path})},window.evo_update_item_tags_by_ajax=function(e,t){var n=jQuery(".token-input-"+t.substr(1));n.removeClass("token-input-list-error").addClass("token-input-list-process"),jQuery.ajax({type:"POST",url:htsrv_url+"action.php",data:{mname:"collections",action:"update_tags",item_ID:e,item_tags:jQuery(t).val(),crumb_collections_update_tags:evo_autocomplete_tags_config.crumb_collections_update_tags},success:function(){n.removeClass("token-input-list-process")},error:function(){n.removeClass("token-input-list-process").addClass("token-input-list-error")}})},window.evo_autocomplete_input_tag_configs=window.evo_autocomplete_input_tag_configs||{};for(var i=Object.values(evo_autocomplete_input_tags_config),a=(n=0,i.length);n<a;n++)!function(){var e=i[n],t="#"+e.input_ID;window.evo_autocomplete_input_tag_configs[t]=e,0!=jQuery("#suggest_item_tags").length&&!jQuery("#suggest_item_tags").is(":checked")||window.init_autocomplete_tags(t,e),jQuery("#suggest_item_tags").click(function(){jQuery(this).is(":checked")?(jQuery(t).hide(),window.init_autocomplete_tags(t)):(jQuery(t).show(),jQuery(t).parent().find("ul.token-input-list-facebook").remove())}),evo_prevent_key_enter("#token-input-"+e.input_ID)}();delete i}"undefined"!=typeof evo_fieldset_folding_config&&(jQuery(document).on("click","span[id^=icon_folding_], span[id^=title_folding_]",function(){var e=jQuery(this).attr("id").match(/^icon_folding_/),t=jQuery(this).closest(".fieldset_wrapper"),n=e?jQuery(this).prev():jQuery(this).prev().prev();if(0==t.length||0==n.length)return!1;"1"==n.val()?(t.removeClass("folded"),n.val("0")):(t.addClass("folded"),n.val("1"));var r=e?jQuery(this):jQuery(this).prev();if(r.hasClass("fa")||r.hasClass("glyphicon")){if(""!=r.data("toggle")){var o=r.hasClass("fa")?"fa":"glyphicon";null==r.data("toggle-orig-class")&&r.data("toggle-orig-class",r.attr("class").replace(new RegExp("^"+o+" (.+)$","g"),"$1")),r.hasClass(r.data("toggle-orig-class"))?r.removeClass(r.data("toggle-orig-class")).addClass(o+"-"+r.data("toggle")):r.removeClass(o+"-"+r.data("toggle")).addClass(r.data("toggle-orig-class"))}}else{var i=r.css("background-position");r.css("background-position",r.data("xy")),r.data("xy",i)}var a=r.attr("title");r.attr("title",r.data("title")),r.data("title",a)}),jQuery("input[type=hidden][id^=folding_value_]").each(function(){var e=jQuery(this).closest(".fieldset_wrapper");"1"==jQuery(this).val()?e.addClass("folded"):e.removeClass("folded")}),jQuery(".field_error").closest(".fieldset_wrapper.folded").find("span[id^=icon_folding_]").click())}),jQuery(document).ready(function(){if("undefined"!=typeof evo_init_password_indicator_config){var c=evo_init_password_indicator_config;window.passcheck=function(){var e=jQuery("input#"+c.pass1_id);if(0!=e.length){c.field_width||(c.field_width=e.outerWidth());var t=jQuery("input#"+c.pass2_id);0!=t.length&&t.css("width",c.field_width-2+"px"),e.css("width",c.field_width-2+"px"),e.attr("onkeyup","return passinfo( this );"),e.parent().append('<div id="p-container"><div id="p-result"></div><div id="p-status"></div><div id="p-time"></div></div>'),jQuery("head").append("<style>#p-container { position: relative; margin-top: 4px; height:5px; border: 1px solid #CCC; font-size: 84%; line-height:normal; color: #999; background: #FFF } #p-result { height:5px } #p-status { position:absolute; width: 100px; top:-5px; left: "+(c.field_width+8)+"px } #p-time { position:absolute; width: 400px } </style>"),jQuery("#p-container").css("width",e.outerWidth()-2);var n=parseInt(e.css("margin-left"));0<n&&jQuery("#p-container").css("margin-left",n+"px")}},window.passinfo=function(e){var t=document.getElementById("p-result"),n=document.getElementById("p-status"),r=document.getElementById("p-time"),o="",i=document.getElementById(c.login_id);null!=i&&""!=i.value&&(o=i.value);var a="",s=document.getElementById(c.email_id);null!=s&&""!=s.value&&(a=s.value);var _=[o,a],d=zxcvbn(e.value,_.concat(c.blacklist)),l="red",u=c.msg_status_very_weak;switch(0==e.value.length?(t.style.display="none",n.style.display="none",r.style.display="none"):(t.style.display="block",n.style.display="block",r.style.display="block"),d.score){case 1:l="#F88158",u=c.msg_status_weak;break;case 2:l="#FBB917",u=c.msg_status_soso;break;case 3:l="#8BB381",u=c.msg_status_good;break;case 4:l="#59E817",u=c.msg_status_great}t.style.width=20*d.score+20+"%",t.style.background=l,c.disp_status&&(n.innerHTML=u),c.disp_time&&(document.getElementById("p-time").innerHTML=c.msg_est_crack_time+": "+d.crack_time_display)},function(){var e;e=function(){var e,t;return(t=document.createElement("script")).src=c.rsc_url+"js/zxcvbn.js",t.type="text/javascript",t.async=!0,(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)},null!=window.attachEvent?window.attachEvent("onload",e):window.addEventListener("load",e,!1)}.call(this),jQuery("input#"+c.pass1_id+", input#"+c.pass2_id).keyup(function(){var e=c.min_pwd_len,t=jQuery("input#"+c.pass1_id),n=jQuery("input#"+c.pass2_id),r=jQuery("#pass2_status"),o="",i=/^[^\<\&\>]+$/g;t.val().length&&null==t.val().match(i)||n.val().length&&null==n.val().match(i)?(o=c.msg_illegal_char,t[0].setCustomValidity(t.val().match(i)?"":o),n[0].setCustomValidity(n.val().match(i)?"":o),r.html(c.error_icon+" "+o)):0<t.val().length&&t.val().length<e||0<n.val().length&&n.val().length<e?(o=c.msg_min_pwd_len,t[0].setCustomValidity(t.val().length<e?o:""),n[0].setCustomValidity(n.val().length<e?o:""),r.html(c.error_icon+" "+o)):n.val()!=t.val()?(o=c.msg_pwd_not_matching,t[0].setCustomValidity(""),n[0].setCustomValidity(o),r.html(c.error_icon+" "+o)):(t[0].setCustomValidity(o),n[0].setCustomValidity(o),r.html(o))}),window.passcheck()}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_init_password_edit_config){var i=evo_init_password_edit_config;window.user_pass_clear_style=function(e){jQuery(e).each(function(){jQuery(this).parent().find("span.field_error span:visible").length?jQuery(this).addClass("field_error"):jQuery(this).removeClass("field_error")})},jQuery("#current_user_pass").keyup(function(){var e=jQuery(this).parent().find("span.field_error");e.length&&(""==jQuery(this).val()?e.show():e.hide()),user_pass_clear_style("#current_user_pass")}),jQuery("#edited_user_pass1, #edited_user_pass2").keyup(function(){var e=jQuery(this).parent().find(".pass_check_min");e.length&&(jQuery.trim(jQuery(this).val()).length>=i.user_minpwdlen?e.hide():e.show());var t=jQuery(".pass_check_diff");t.length&&jQuery("#edited_user_pass1").val()==jQuery(" #edited_user_pass2").val()&&t.hide();var n=jQuery(this).parent().find(".pass_check_new");n.length&&(""==jQuery(this).val()?n.show():n.hide());var r=jQuery(this).parent().find(".pass_check_twice");r.length&&(""==jQuery(this).val()?r.show():r.hide());var o=jQuery(this).parent().find(".pass_check_warning");jQuery.trim(jQuery(this).val())!=jQuery(this).val()?o.length||jQuery(this).parent().append('<span class="pass_check_warning notes field_error">'+i.msg_pwd_trim_warning+"</span>"):o.length&&o.remove(),user_pass_clear_style("#edited_user_pass1, #edited_user_pass2")})}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_init_login_validator_config){var e=evo_init_login_validator_config,n=e.login_icon_load,r=e.login_icon_exists,o=e.login_icon_error,i=e.login_text_empty,a=e.login_text_exists,s=jQuery("#register_form input#"+e.login_id);s.change(function(){var t=jQuery("#login_status_msg");""==jQuery(this).val()?(jQuery("#login_status").html(""),t.html(i).attr("class","notes")):(jQuery("#login_status").html(n),jQuery.ajax({type:"POST",url:e.login_htsrv_url+"anon_async.php",data:"action=validate_login&login="+jQuery(this).val(),success:function(e){"exists"==(e=ajax_debug_clear(e))?(jQuery("#login_status").html(""),t.html(r+" "+a).attr("class","red"),s[0].setCustomValidity(a)):"available"==e?(jQuery("#login_status").html(""),t.html(""),s[0].setCustomValidity("")):(jQuery("#login_status").html(""),t.html(o.replace("$error_msg$",e.replace(/(<([^>]+)>)/gi,""))+" "+e).attr("class","red"),s[0].setCustomValidity(e.replace(/(<([^>]+)>)/gi,"")))}}))})}}),jQuery(document).ready(function(){"undefined"!=typeof evo_skin_bootstrap_forums__post_list_header&&jQuery("#evo_workflow_status_filter").change(function(){var e=location.href.replace(/([\?&])((status|redir)=[^&]*(&|$))+/,"$1"),t=jQuery(this).val();""!==t&&(e+=(-1==e.indexOf("?")?"?":"&")+"status="+t+"&redir=no"),location.href=e.replace("?&","?").replace(/\?$/,"")})}),jQuery(document).ready(function(){"undefined"!=typeof evo_widget_coll_search_form&&(jQuery(evo_widget_coll_search_form.selector).tokenInput(evo_widget_coll_search_form.url,evo_widget_coll_search_form.config),void 0!==evo_widget_coll_search_form.placeholder&&jQuery("#token-input-search_author").attr("placeholder",evo_widget_coll_search_form.placeholder).css("width","100%"))}),jQuery(document).ready(function(){"undefined"!=typeof evo_autocomplete_login_config&&(jQuery("input.autocomplete_login").on("added",function(){jQuery("input.autocomplete_login").each(function(){if(!jQuery(this).hasClass("tt-input")&&!jQuery(this).hasClass("tt-hint")){var t="";t=jQuery(this).hasClass("only_assignees")?restapi_url+evo_autocomplete_login_config.url:restapi_url+"users/logins",jQuery(this).data("status")&&(t+="&status="+jQuery(this).data("status")),jQuery(this).typeahead(null,{displayKey:"login",source:function(e,r){jQuery.ajax({type:"GET",dataType:"JSON",url:t,data:{q:e},success:function(e){var t=new Array;for(var n in e.list)t.push({login:e.list[n]});r(t)}})}})}})}),jQuery("input.autocomplete_login").trigger("added"),evo_prevent_key_enter(evo_autocomplete_login_config.selector))}),jQuery(document).ready(function(){"undefined"!=typeof evo_widget_poll_initialize&&(jQuery('.evo_poll__selector input[type="checkbox"]').on("click",function(){var e=jQuery(this).closest(".evo_poll__table"),t=jQuery(".evo_poll__selector input:checked",e).length>=e.data("max-answers");jQuery(".evo_poll__selector input[type=checkbox]:not(:checked)",e).prop("disabled",t)}),jQuery(".evo_poll__table").each(function(){var e=jQuery(this);e.width()>e.parent().width()&&(jQuery(".evo_poll__title",e).css("white-space","normal"),jQuery(".evo_poll__title label",e).css({width:Math.floor(e.parent().width()/2)+"px","word-wrap":"break-word"}))}))}),jQuery(document).ready(function(){if("undefined"!=typeof evo_plugin_auto_anchors_settings){jQuery("h1, h2, h3, h4, h5, h6").each(function(){if(jQuery(this).attr("id")&&jQuery(this).hasClass("evo_auto_anchor_header")){var e=location.href.replace(/#.+$/,"")+"#"+jQuery(this).attr("id");jQuery(this).append(' <a href="'+e+'" class="evo_auto_anchor_link"><span class="fa fa-link"></span></a>')}});var t=jQuery("#evo_toolbar").length?jQuery("#evo_toolbar").height():0;jQuery(".evo_auto_anchor_link").on("click",function(){var e=jQuery(this).attr("href");return jQuery("html,body").animate({scrollTop:jQuery(this).offset().top-t-evo_plugin_auto_anchors_settings.offset_scroll},function(){window.history.pushState("","",e)}),!1})}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_init_custom_tags_toolbar_config)for(var e=Object.values(evo_init_custom_tags_toolbar_config),t=0;t<e.length;t++){var i=e[t];!function(){var o=i.js_prefix+i.plugin_code+"_";window[o+"tagButtons"]=new Array,window[o+"tagOpenTags"]=new Array,window[o+"tagButton"]=function(e,t,n,r,o,i,a,s){this.id=e,this.display=t,this.style=n,this.tagStart=r,this.tagEnd=o,this.access=i,this.title=a,this.open=s};for(var e=Object.values(i.tag_buttons),n=0,r=e.length;n<r;n++)window[o+"tagButtons"][window[o+"tagButtons"].length]=new window[o+"tagButton"]("tag_"+e[n].title,e[n].name,"",e[n].start,e[n].end,"",e[n].title);window[o+"tagGetButton"]=function(e,t){return'<input type="button" id="'+e.id+'" accesskey="'+e.access+'" title="'+e.title+'" style="'+e.style+'" class="'+i.toolbar_button_class+'" data-func="'+o+"tagInsertTag|"+i.js_prefix+"b2evoCanvas|"+t+'" value="'+e.display+'" />'},window[o+"tagAddTag"]=function(e){""!=window[o+"tagButtons"][e].tagEnd&&(window[o+"tagOpenTags"][window[o+"tagOpenTags"].length]=e,document.getElementById(window[o+"tagButtons"][e].id).style.fontWeight="bold")},window[o+"tagRemoveTag"]=function(e){for(n=0,r=window[o+"tagOpenTags"].length;n<r;n++)window[o+"tagOpenTags"][n]==e&&(window[o+"tagOpenTags"].splice(n,1),document.getElementById(window[o+"tagButtons"][e].id).style.fontWeight="normal")},window[o+"tagCheckOpenTags"]=function(e){var t=0;for(n=0,r=window[o+"tagOpenTags"].length;n<r;n++)window[o+"tagOpenTags"][n]==e&&t++;return 0<t},window[o+"tagCloseAllTags"]=function(){var e=window[o+"tagOpenTags"].length;for(n=0;n<e;n++)window[o+"tagInsertTag"](window[i.js_prefix+"b2evoCanvas"],window[o+"tagOpenTags"][window[o+"tagOpenTags"].length-1])},window[o+"tagToolbar"]=function(){var e=i.toolbar_title_before+i.toolbar_label+" "+i.toolbar_title_after;e+=i.toolbar_group_before;for(var t=0,n=window[o+"tagButtons"].length;t<n;t++)e+=window[o+"tagGetButton"](window[o+"tagButtons"][t],t);e+=i.toolbar_group_after+i.toolbar_group_before,e+='<input type="button" id="tag_close" class="'+i.toolbar_button_class+'" data-func="'+o+'tagCloseAllTags" title="'+i.btn_title_close_all_tags+'" value="X" />',e+=i.toolbar_group_after,jQuery("."+o+"toolbar").html(e)},window[o+"tagInsertTag"]=function(e,t){var n=b2evo_Callbacks.trigger_callback("get_selected_text_for_"+e.id),r=!1;null!=n&&0!=n||(document.selection?(e.focus(),n=document.selection.createRange().text,r=!0):!e.selectionStart&&"0"!=e.selectionStart||(n=e.selectionStart!=e.selectionEnd)),n?textarea_wrap_selection(e,window[o+"tagButtons"][t].tagStart,window[o+"tagButtons"][t].tagEnd,0):window[o+"tagCheckOpenTags"](t)&&""!=window[o+"tagButtons"][t].tagEnd?(textarea_wrap_selection(e,"",window[o+"tagButtons"][t].tagEnd,0),window[o+"tagRemoveTag"](t)):(textarea_wrap_selection(e,window[o+"tagButtons"][t].tagStart,"",0),window[o+"tagAddTag"](t)),r&&e.focus()},window[o+"tagToolbar"]()}()}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_plugin_table_contents_settings){var n=jQuery("#evo_toolbar").length?jQuery("#evo_toolbar").height():0;jQuery(".evo_plugin__table_of_contents a").on("click",function(){var e=jQuery("#"+jQuery(this).data("anchor"));if(0==e.length||!e.prop("tagName").match(/^h[1-6]$/i))return!0;var t=jQuery(this).attr("href");return jQuery("html,body").animate({scrollTop:e.offset().top-n-evo_plugin_table_contents_settings.offset_scroll},function(){window.history.pushState("","",t)}),!1})}}),jQuery(document).ready(function(){if(window.evo_init_tinymce=function(o){o.toggle_switch_warning&&(window.toggle_switch_warning=function(t){var e=o.toggle_switch_warning.activate_link,n=o.toggle_switch_warning.deactivate_link;return jQuery.get(t?e:n,function(e){jQuery(document).trigger("wysiwyg_warning_changed",[t])}),!1}),o.expert_quicksettings&&jQuery(document).on("wysiwyg_warning_changed",function(e,t){jQuery("#"+o.expert_quicksettings.item_id).html(t?o.expert_quicksettings.deactivate_warning_link:o.expert_quicksettings.activate_warning_link)}),o.toggle_editor&&(window.evo_tinymce_display_toggle_editor_warning=window.evo_tinymce_display_toggle_editor_warning||o.toggle_editor.display_warning,window.confirm_switch=function(e){return jQuery("input[name=hideWarning]").is(":checked")&&window.toggle_switch_warning(!1),window.tinymce_plugin_toggleEditor(e,!0),closeModalWindow(),!1},window.tinymce_plugin_toggleEditor=function(e,t){var n=jQuery("#"+e);if(jQuery('[data-content-id="'+e+'"] [id^="tinymce_plugin_toggle_button_"]').removeClass("active").attr("disabled","disabled"),!window["tinymce_plugin_init_done_"+e])return window["tinymce_plugin_init_done_"+e]=!0,void window.tinymce_plugin_init_tinymce(function(){window.tinymce_plugin_toggleEditor(e,!0)});!window.tinymce.get(e)||t?(window.tinymce.execCommand("mceAddEditor",!1,e),jQuery.get(o.toggle_editor.save_state_wysiwyg_url),jQuery("#tinymce_plugin_toggle_button_wysiwyg").addClass("active"),jQuery("#tinymce_plugin_toggle_button_html").removeAttr("disabled"),jQuery('[name="editor_code"]').attr("value",o.plugin_code),jQuery(".quicktags_toolbar, .evo_code_toolbar, .evo_prism_toolbar, .b2evMark_toolbar, .evo_mermaid_toolbar").hide(),jQuery("#block_renderer_evo_code, #block_renderer_evo_prism, #block_renderer_b2evMark, #block_renderer_evo_mermaid").addClass("disabled"),jQuery("input#renderer_evo_code, input#renderer_evo_prism, input#renderer_b2evMark, input#renderer_evo_mermaid").each(function(){jQuery(this).is(":checked")&&jQuery(this).addClass("checked"),jQuery(this).attr("disabled","disabled").removeAttr("checked")}),e&&n.prop("required")&&(n.attr("data-required",!0),n.removeAttr("required"))):(window.tinymce.execCommand("mceRemoveEditor",!1,e),jQuery.get(o.toggle_editor.save_state_html_url),jQuery("#tinymce_plugin_toggle_button_html").addClass("active"),jQuery("#tinymce_plugin_toggle_button_wysiwyg").removeAttr("disabled"),jQuery('[name="editor_code"]').attr("value","html"),jQuery(".quicktags_toolbar, .evo_code_toolbar, .evo_prism_toolbar, .b2evMark_toolbar, .evo_mermaid_toolbar").show(),jQuery("#block_renderer_evo_code, #block_renderer_evo_prism, #block_renderer_b2evMark, #block_renderer_evo_mermaid").removeClass("disabled"),jQuery("input#renderer_evo_code, input#renderer_evo_prism, input#renderer_b2evMark, input#renderer_evo_mermaid").each(function(){jQuery(this).hasClass("checked")&&jQuery(this).attr("checked","checked").removeClass("checked"),jQuery(this).removeAttr("disabled")}),e&&n.attr("data-required")&&(n.removeAttr("data-required"),n.attr("required",!0)))},jQuery(document).on("wysiwyg_warning_changed",function(e,t){window.evo_tinymce_display_toggle_editor_warning=t}),jQuery("[id^=tinymce_plugin_toggle_button_]").click(function(){var e=jQuery(this).parent().data("contentId");if(!e)return!1;"WYSIWYG"==jQuery(this).val()&&window.evo_tinymce_display_toggle_editor_warning?(evo_js_lang_close=o.toggle_editor.btn_label_cancel,openModalWindow("<p>"+o.toggle_editor.toggle_warning_msg+'</p><form><input type="checkbox" name="hideWarning" value="1"> '+o.toggle_editor.wysiwyg_checkbox_label+'<input type="submit" name="submit" onclick="return window.confirm_switch( \''+e+"' );\"></form>","500px","",!0,'<span class="text-danger">'+o.toggle_editor.warning_text+"</span>",[o.toggle_editor.btn_label_ok,"btn-primary"],!0)):window.tinymce_plugin_toggleEditor(e)})),o.editor&&(window.tinymce_plugin_displayed_error=window.tinymce_plugin_displayed_error||!1,window["tinymce_plugin_init_done_"+o.content_id]=window["tinymce_plugin_init_done_"+o.content_id]||!1,window.tinymce_autocomplete_static_options=[],jQuery(".user.login").each(function(){var e=jQuery(this).text();""!=e&&-1==window.tinymce_autocomplete_static_options.indexOf(e)&&("@"==e[0]&&(e=e.substr(1)),window.tinymce_autocomplete_static_options.push(e))}),window.tinymce_autocomplete_static_options=window.tinymce_autocomplete_static_options.join(),window.tinymce_plugin_init_tinymce=function(t){void 0===window.tinymce?window.tinymce_plugin_displayed_error||(alert(o.editor.display_error_msg),window.tinymce_plugin_displayed_error=!0):(void 0!==o.editor.tmce_init.oninit&&(t=function(){o.editor.tmce_init.oninit(),t()}),o.editor.tmce_init.oninit=function(){t(),window.tinymce.get(o.content_id)&&"object"==typeof b2evo_Callbacks&&(b2evo_Callbacks.register_callback("get_selected_text_for_"+o.content_id,function(e){var t=window.tinymce.get(o.content_id);return t?t.selection.getContent():null},!0),b2evo_Callbacks.register_callback("wrap_selection_for_"+o.content_id,function(e){var t=window.tinymce.get(o.content_id);if(!t)return null;var n=t.selection.getContent();if(e.replace)var r=e.before+e.after;else r=e.before+n+e.after;return t.selection.setContent(r),!0},!0),b2evo_Callbacks.register_callback("str_replace_for_"+o.content_id,function(e){var t=window.tinymce.get(o.content_id);return t?(t.setContent(t.getContent().replace(e.search,e.replace)),!0):null},!0),b2evo_Callbacks.register_callback("insert_raw_into_"+o.content_id,function(e){return window.tinymce.execInstanceCommand(o.content_id,"mceInsertRawHTML",!1,e),!0},!0));var e=jQuery("#"+o.content_id);e.prop("required")&&(e.attr("data-required",!0),e.removeAttr("required"))},o.editor.tmce_init.init_instance_callback=function(e){if(window.shortcut_keys)for(var t=0;t<window.shortcut_keys.length;t++){var n=window.shortcut_keys[t];e.shortcuts.add(n,"b2evo shortcut key: "+n,function(){window.shortcut_handler(n)})}},o.editor.tmce_init.setup=function(e){e.on("init",o.editor.tmce_init.oninit)},window.tinymce.on("AddEditor",function(t){var e=jQuery("#"+o.content_id);return e.val().match(/<(p\s?|br\s?\/?)[^>]*>/i)||jQuery.ajax({type:"POST",url:o.editor.update_content_url,data:{content:e.val(),crumb_tinymce:o.editor.crumb_tinymce},success:function(e){t.editor.setContent(e)}}),!1}),window.tinymce.init(o.editor.tmce_init))},1==o.editor.use_tinymce&&window.tinymce_plugin_toggleEditor(o.content_id),jQuery('[name="editor_code"]').attr("value",o.plugin_code))},"undefined"!=typeof evo_tinymce_config){for(var e=Object.values(evo_tinymce_config),t=0,n=e.length;t<n;t++)r=e[t],window.evo_init_tinymce(r);delete e}var r}),jQuery(document).ready(function(){if(window.evo_init_shortlinks_toolbar=function(n){window.shortlinks_toolbar=function(e){var t=n.toolbar_title_before+e+n.toolbar_title_after+n.toolbar_group_before+'<input type="button" title="'+n.button_title+'" class="'+n.button_class+'" data-func="shortlinks_load_window|'+n.js_prefix+'" value="'+n.button_value+'" />'+n.toolbar_group_after;jQuery("."+n.js_prefix+n.plugin_code+"_toolbar").html(t)},window.shortlinks_toolbar(n.toolbar_title)},"undefined"!=typeof evo_init_shortlinks_toolbar_config){for(var e=Object.values(evo_init_shortlinks_toolbar_config),t=0;t<e.length;t++)window.evo_init_shortlinks_toolbar(e[t]);delete e}}),jQuery(document).ready(function(){if(window.evo_init_inlines_toolbar=function(i){var r=i.target_ID,o=i.temp_ID,a=i.target_type,s=new Array;window.inline_button=function(e,t,n,r,o){this.id=e,this.text=t,this.type=n,this.title=r,this.style=o},s[s.length]=new window.inline_button("inline_image","image","image",i.button_title,""),window.inline_toolbar=function(e,t){for(var n=i.toolbar_title_before+e+i.toolbar_title_after+i.toolbar_group_before,r=0;r<s.length;r++){var o=s[r];n+='<input type="button" id="'+o.id+'" title="'+o.title+'"'+(void 0!==o.style?' style="'+o.style+'"':"")+' class="'+i.button_class+'" data-func="insert_inline|'+o.type+'" value="'+o.text+'" />'}n+=i.toolbar_group_after,jQuery("."+t+i.plugin_code+"_toolbar").html(n)},window.insert_inline=function(){switch(a){case"Item":if(!r&&!o)return alert(evo_js_lang_alert_before_insert_item),!1;break;case"Comment":if(!r)return alert(evo_js_lang_alert_before_insert_comment),!1;break;case"EmailCampaign":if(!r)return alert(evo_js_lang_alert_before_insert_emailcampaign),!1;break;case"Message":if(!r&&!o)return alert(evo_js_lang_alert_before_insert_message),!1}"undefined"!=typeof tinyMCE&&void 0!==tinyMCE.activeEditor&&tinyMCE.activeEditor?(tinyMCE.execCommand("mceFocus",!1,tinyMCE.activeEditor.id),tinyMCE.execCommand("evo_view_edit_inline",!1,tinyMCE.activeEditor.id)):(openModalWindow('<span class="loader_img loader_user_report absolute_center" title="'+evo_js_lang_loading+'..."></span>',"80%","",!0,evo_js_lang_select_image_insert,"",!0),jQuery.ajax({type:"POST",url:i.insert_inline_url,success:function(e){var t,n;n=null==o?(t=a,r):(t="temporary",o),openModalWindow(e,"90%","80%",!0,"Select image","","","","","",function(){evo_link_refresh_list(t,n,"refresh"),evo_link_fix_wrapper_height()})}}))},window.inline_toolbar(i.toolbar_title,i.prefix)},"undefined"!=typeof evo_init_inlines_toolbar_config){for(var e=Object.values(evo_init_inlines_toolbar_config),t=0;t<e.length;t++)window.evo_init_inlines_toolbar(e[t]);delete e}}),jQuery(document).ready(function(){if(window.evo_init_markdown_toolbar=function(o){window[o.js_prefix+"markdown_btns"]=new Array,window[o.js_prefix+"markdown_open_tags"]=new Array,window.markdown_btn=function(e,t,n,r,o,i,a,s){this.id=e,this.text=t,this.title=n,this.tag_start=r,this.tag_end=o,this.style=i,this.open=a,this.grp_pos=s},o.enable_text_styles&&(window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_bold","bold",o.btn_title_bold,"**","**","font-weight:bold"),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_italic","italic",o.btn_title_italic,"*","*","font-style:italic",-1,"last")),o.enable_links&&(window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_link","link",o.btn_title_link,"","","text-decoration:underline",-1,o.enable_images?void 0:"last")),o.enable_images&&(window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_img","img",o.btn_title_image,"","","",-1,"last")),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_h1","H1",o.btn_title_h1,"\n# ","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_h2","H2",o.btn_title_h2,"\n## ","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_h3","H3",o.btn_title_h3,"\n### ","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_h4","H4",o.btn_title_h4,"\n#### ","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_h5","H5",o.btn_title_h5,"\n##### ","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_h6","H6",o.btn_title_h6,"\n###### ","","",-1,"last"),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_li","li",o.btn_title_li,"\n* ","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_ol","ol",o.btn_title_ol,"\n1. ","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_blockquote","blockquote",o.btn_title_blockquote,"\n> ","","",-1,"last"),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_codespan","codespan",o.btn_title_codespan,"`","`","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_preblock","preblock",o.btn_title_preblock,"\n\t","","",-1,"last"),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_codeblock","codeblock",o.btn_title_codeblock,"\n```\n","\n```\n","",-1,"last"),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_hr","hr",o.btn_title_hr,"\n---\n","","",-1),window[o.js_prefix+"markdown_btns"][window[o.js_prefix+"markdown_btns"].length]=new markdown_btn(o.js_prefix+"mrkdwn_br","<br>",o.btn_title_br,"  \n","","",-1),window[o.js_prefix+"markdown_get_btn"]=function(e,t){var n="";return e.id==window[o.js_prefix+"mrkdwn_img"]?n+='<input type="button" id="'+e.id+'" accesskey="'+e.access+'" title="'+e.title+'" style="'+e.style+'" class="'+o.toolbar_button_class+'" data-func="'+o.js_prefix+"markdown_insert_lnkimg|"+o.js_prefix+'b2evoCanvas|img" value="'+e.text+'" />':e.id==o.js_prefix+"mrkdwn_link"?n+='<input type="button" id="'+e.id+'" accesskey="'+e.access+'" title="'+e.title+'" style="'+e.style+'" class="'+o.toolbar_button_class+'" data-func="'+o.js_prefix+"markdown_insert_lnkimg|"+o.js_prefix+'b2evoCanvas" value="'+e.text+'" />':n+='<input type="button" id="'+e.id+'" accesskey="'+e.access+'" title="'+e.title+'" style="'+e.style+'" class="'+o.toolbar_button_class+'" data-func="'+o.js_prefix+"markdown_insert_tag|"+o.js_prefix+"b2evoCanvas|"+t+'" value="'+e.text+'" />',n},window[o.js_prefix+"markdown_add_tag"]=function(e){""!=window[o.js_prefix+"markdown_btns"][e].tag_end&&(window[o.js_prefix+"markdown_open_tags"][window[o.js_prefix+"markdown_open_tags"].length]=e,document.getElementById(window[o.js_prefix+"markdown_btns"][e].id).value="/"+document.getElementById(window[o.js_prefix+"markdown_btns"][e].id).value)},window[o.js_prefix+"markdown_remove_tag"]=function(e){for(n=0;n<window[o.js_prefix+"markdown_open_tags"].length;n++)window[o.js_prefix+"markdown_open_tags"][n]==e&&(window[o.js_prefix+"markdown_open_tags"].splice(n,1),document.getElementById(window[o.js_prefix+"markdown_btns"][e].id).value=document.getElementById(window[o.js_prefix+"markdown_btns"][e].id).value.replace("/",""))},window[o.js_prefix+"markdown_check_open_tags"]=function(e){var t=0;for(n=0;n<window[o.js_prefix+"markdown_open_tags"].length;n++)window[o.js_prefix+"markdown_open_tags"][n]==e&&t++;return 0<t},window[o.js_prefix+"markdown_close_all_tags"]=function(){for(var e=window[o.js_prefix+"markdown_open_tags"].length,t=0;t<e;t++)window[o.js_prefix+"markdown_insert_tag"](window[o.js_prefix+"b2evoCanvas"],window[o.js_prefix+"markdown_open_tags"][window[o.js_prefix+"markdown_open_tags"].length-1])},window[o.js_prefix+"markdown_toolbar"]=function(e){for(var t=o.toolbar_title_before+e+o.toolbar_title_after+o.toolbar_group_before,n=0;n<window[o.js_prefix+"markdown_btns"].length;n++)t+=window[o.js_prefix+"markdown_get_btn"](window[o.js_prefix+"markdown_btns"][n],n),"last"==window[o.js_prefix+"markdown_btns"][n].grp_pos&&0<n&&n<window[o.js_prefix+"markdown_btns"].length-1&&(t+=o.toolbar_group_after+o.toolbar_group_before);t+=o.toolbar_group_after+o.toolbar_group_before+'<input type="button" id="'+o.js_prefix+'mrkdwn_close" class="'+o.toolbar_button_class+'" data-func="'+o.js_prefix+'markdown_close_all_tags" title="'+o.btn_title_close_all_tags+'" value="X" />'+o.toolbar_group_after,jQuery("."+o.js_prefix+o.plugin_code+"_toolbar").html(t)},window[o.js_prefix+"markdown_insert_tag"]=function(e,t){var n=b2evo_Callbacks.trigger_callback("get_selected_text_for_"+e.id),r=!1;null==n&&(document.selection?(e.focus(),n=document.selection.createRange().text,r=!0):!e.selectionStart&&"0"!=e.selectionStart||(n=e.selectionStart!=e.selectionEnd)),n?textarea_wrap_selection(e,window[o.js_prefix+"markdown_btns"][t].tag_start,window[o.js_prefix+"markdown_btns"][t].tag_end,0):window[o.js_prefix+"markdown_check_open_tags"](t)&&""!=window[o.js_prefix+"markdown_btns"][t].tag_end?(textarea_wrap_selection(e,"",window[o.js_prefix+"markdown_btns"][t].tag_end,0),window[o.js_prefix+"markdown_remove_tag"](t)):(textarea_wrap_selection(e,window[o.js_prefix+"markdown_btns"][t].tag_start,"",0),window[o.js_prefix+"markdown_add_tag"](t)),r&&e.focus()},window[o.js_prefix+"markdown_insert_lnkimg"]=function(e,t){var n=prompt(o.prompt_url+":","http://");if(n){n="["+prompt(o.prompt_text+":","")+"]("+n;var r=prompt(o.prompt_title+":","");""!=r&&(n+=' "'+r+'"'),n+=")",void 0!==t&&"img"==t&&(n="!"+n),textarea_wrap_selection(e,n,"",1)}},window[o.js_prefix+"markdown_toolbar"](o.toolbar_title+": ")},"undefined"!=typeof evo_init_markdown_toolbar_config){for(var e=Object.values(evo_init_markdown_toolbar_config),n=0;n<e.length;n++)window.evo_init_markdown_toolbar(e[n]);delete e}}),jQuery(document).ready(function(){if(window.evo_init_polls_toolbar=function(r){window.polls_toolbar=function(e,t){var n=r.toolbar_title_before+e+r.toolbar_title_after+r.toolbar_group_before+'<input type="button" title="'+r.button_title+'" class="'+r.button_class+'" data-func="polls_load_window|'+t+'" value="'+r.button_value+'" />'+r.toolbar_group_after;jQuery("."+t+r.plugin_code+"_toolbar").html(n)},window.polls_load_window=function(e){return openModalWindow('<div id="poll_wrapper"></div>',"auto","",!0,r.modal_window_title,["Insert Poll"],!0),polls_load_polls(e),!1},window.polls_api_request=function(e,t,n){jQuery.ajax({url:restapi_url+e}).then(n,function(e){polls_api_print_error(t,e)})},window.polls_api_print_error=function(e,t){if("string"!=typeof t&&void 0===t.code&&(t=void 0===t.responseJSON?t.statusText:t.responseJSON),void 0===t.code)var n='<h4 class="text-danger">Unknown error: '+t+"</h4>";else n='<h4 class="text-danger">'+t.message+"</h4>",r.debug&&(n+="<div><b>Code:</b> "+t.code+"</div><div><b>Status:</b> "+t.data.status+"</div>");jQuery(e).html(n)},window.polls_load_polls=function(o){o=o||"",polls_api_request("polls","#poll_wrapper",function(e){var t='<div id="'+o+'polls_list">';for(var n in t+="<ul>",e.polls){var r=e.polls[n];t+='<li><a href="#" data-poll-id="'+r.pqst_ID+'" data-prefix="'+o+'">'+r.pqst_question_text+"</a></li>"}t+="</ul>",t+="</div>",jQuery("#poll_wrapper").html(t),jQuery(document).on("click","#"+o+"polls_list a[data-poll-id]",function(){"undefined"!=typeof tinyMCE&&void 0!==tinyMCE.activeEditor&&tinyMCE.activeEditor&&tinyMCE.execCommand("mceFocus",!1,tinyMCE.activeEditor.id);var e=jQuery(this).data("prefix")?jQuery(this).data("prefix"):"";return textarea_wrap_selection(window[e+"b2evoCanvas"],"[poll:"+jQuery(this).data("pollId")+"]","",0),closeModalWindow(),!1})})},window.polls_toolbar(r.toolbar_title,r.prefix)},"undefined"!=typeof evo_init_polls_toolbar_config){for(var e=Object.values(evo_init_polls_toolbar_config),t=0;t<e.length;t++)window.evo_init_polls_toolbar(e[t]);delete e}}),jQuery(document).ready(function(){if(window.evo_init_shortcodes_toolbar=function(i){window[i.js_prefix+"shortcodes_buttons"]=new Array,window.shortcodes_button=function(e,t,n,r,o){this.id=e,this.text=t,this.tag=n,this.title=r,this.style=o},window[i.js_prefix+"shortcodes_buttons"][window[i.js_prefix+"shortcodes_buttons"].length]=new shortcodes_button("shortcodes_teaserbreak","[teaserbreak]","[teaserbreak]",i.btn_title_teaserbreak,""),window[i.js_prefix+"shortcodes_buttons"][window[i.js_prefix+"shortcodes_buttons"].length]=new shortcodes_button("shortcodes_pagebreak","[pagebreak]","[pagebreak]",i.btn_title_pagebreak,""),window[i.js_prefix+"shortcodes_toolbar"]=function(e){for(var t=i.toolbar_title_before+e+i.toolbar_title_after+i.toolbar_group_before,n=0,r=window[i.js_prefix+"shortcodes_buttons"].length;n<r;n++){var o=window[i.js_prefix+"shortcodes_buttons"][n];t+='<input type="button" id="'+o.id+'" title="'+o.title+'"'+(void 0!==o.style?' style="'+o.style+'"':"")+' class="'+i.toolbar_button_class+'" data-func="'+i.js_prefix+"shortcodes_insert_tag|"+i.js_prefix+"b2evoCanvas|"+n+'" value="'+o.text+'" />'}t+=i.toolbar_group_after,jQuery("."+i.js_prefix+i.plugin_code+"_toolbar").html(t)},window[i.js_prefix+"shortcodes_insert_tag"]=function(e,t){"undefined"!=typeof tinyMCE&&void 0!==tinyMCE.activeEditor&&tinyMCE.activeEditor&&tinyMCE.execCommand("mceFocus",!1,tinyMCE.activeEditor.id),textarea_wrap_selection(e,window[i.js_prefix+"shortcodes_buttons"][t].tag,"",0)},window[i.js_prefix+"shortcodes_toolbar"](i.toolbar_title+": ")},"undefined"!=typeof evo_init_shortcodes_toolbar_config){for(var e=Object.values(evo_init_shortcodes_toolbar_config),t=0;t<e.length;t++)window.evo_init_shortcodes_toolbar(e[t]);delete e}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_init_widescroll_toolbar_config)for(var e=Object.values(evo_init_widescroll_toolbar_config),t=0;t<e.length;t++){var i=e[t];window[i.js_prefix+"widescroll_buttons"]=new Array,window[i.js_prefix+"widescroll_buttons"][window[i.js_prefix+"widescroll_buttons"].length]=new function(e,t,n,r,o,i){this.id="widescroll",this.text="wide scroll",this.tag_open='<div class="wide_scroll">',this.tag_close="</div>",this.title=o,this.style=""}("widescroll","wide scroll",'<div class="wide_scroll">',"</div>",i.btn_title_teaserbreak,""),window[i.js_prefix+"widescroll_toolbar"]=function(e){for(var t=i.toolbar_title_before+e+i.toolbar_title_after+i.toolbar_group_before,n=0,r=window[i.js_prefix+"widescroll_buttons"].length;n<r;n++){var o=window[i.js_prefix+"widescroll_buttons"][n];t+='<input type="button" id="'+o.id+'" title="'+o.title+'"'+(void 0!==o.style?' style="'+o.style+'"':"")+' class="'+i.toolbar_button_class+'" data-func="'+i.js_prefix+"widescroll_insert_tag|"+i.js_prefix+"b2evoCanvas|"+n+'" value="'+o.text+'" />'}t+=i.toolbar_group_after,jQuery("."+i.js_prefix+i.plugin_code+"_toolbar").html(t)},window[i.js_prefix+"widescroll_insert_tag"]=function(e,t){"undefined"!=typeof tinyMCE&&void 0!==tinyMCE.activeEditor&&tinyMCE.activeEditor&&tinyMCE.execCommand("mceFocus",!1,tinyMCE.activeEditor.id),textarea_wrap_selection(e,window[i.js_prefix+"widescroll_buttons"][t].tag_open,window[i.js_prefix+"widescroll_buttons"][t].tag_close,0)},window[i.js_prefix+"widescroll_toolbar"](i.toolbar_title+": ")}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_init_editable_column_config)for(var keys=Object.keys(evo_init_editable_column_config),i=0;i<keys.length;i++)!function(){var config=evo_init_editable_column_config[keys[i]];0<jQuery(config.column_selector).length&&jQuery(config.column_selector).editable(config.ajax_url,{data:function(value,settings){if(value=ajax_debug_clear(value),"select"==config.field_type){var result=value.match(/rel="([^"]*)"/);return config.options_eval?eval(config.options_eval):config.options instanceof Object?jQuery.extend({},config.options,{selected:result[1]}):config.options}var result=value.match(/>\s*([^<]+)\s*</);return result[1]==config.null_text?"":result[1]},type:config.field_type,class_name:config.field_class,name:config.new_field_name,tooltip:config.tooltip,event:"click",onblur:"text"==config.field_type?"submit":"cancel",onedit:function(e,t){var n=jQuery(t).width();jQuery(t).css({width:n,"max-width":n})},callback:function(settings,original){if(config.colored_cells){jQuery(this).html(ajax_debug_clear(settings));var link=jQuery(this).find("a");jQuery(this).css("background-color","none"==link.attr("color")?"transparent":link.attr("color")),link.removeAttr("color")}else"function"==typeof evoFadeSuccess&&evoFadeSuccess(this);config.callback_code&&eval(config.callback_code)},submitdata:function(value,settings){var return_obj={};return return_obj[config.ID_name]=eval(config.ID_value),return_obj},onerror:function(e,t,n){"function"==typeof evoFadeFailure&&evoFadeFailure(t);var r=jQuery(t).find("input");0<r.length&&(jQuery(t).find("span.field_error").remove(),r.addClass("field_error"),void 0!==n.responseText&&r.after('<span class="note field_error">'+n.responseText+"</span>"))}})}()}),jQuery(document).ready(function(){if("undefined"!=typeof evo_regional_config){window.check_regional_required_fields=function(e){jQuery("#"+e+"_rgn_ID, #"+e+"_subrg_ID, #"+e+"_city_ID").each(function(){void 0!==jQuery(this).attr("required")||!0===jQuery(this).data("required")?(1<jQuery(this).find("option").length?jQuery(this).attr("required","required"):jQuery(this).removeAttr("required"),jQuery(this).data("required",!0)):jQuery(this).data("required",!1)})},window.load_regions=function(e,t,n){jQuery("#"+n+"_rgn_ID").next().find("button").hide().next().show(),jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_regions_option_list&page=edit&mode=load_all&ctry_id="+e+"&rgn_id="+t,success:function(e){jQuery("#"+n+"_rgn_ID").next().find("button").show().next().hide();var t=(e=ajax_debug_clear(e)).split("-##-");jQuery("#"+n+"_rgn_ID").html(t[0]),jQuery("#"+n+"_subrg_ID").html(t[1]),jQuery("#"+n+"_city_ID").html(t[2]),window.check_regional_required_fields(n)}})},window.load_subregions=function(e,t,n){jQuery("#"+n+"_subrg_ID").next().find("button").hide().next().show(),jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_subregions_option_list&page=edit&mode=load_all&ctry_id="+e+"&rgn_id="+t,success:function(e){jQuery("#"+n+"_subrg_ID").next().find("button").show().next().hide();var t=(e=ajax_debug_clear(e)).split("-##-");jQuery("#"+n+"_subrg_ID").html(t[0]),jQuery("#"+n+"_city_ID").html(t[1]),window.check_regional_required_fields(n)}})},window.load_cities=function(e,t,n,r){jQuery("#"+r+"_city_ID").next().find("button").hide().next().show(),jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_cities_option_list&page=edit&ctry_id="+e+"&rgn_id="+t+"&subrg_id="+n,success:function(e){jQuery("#"+r+"_city_ID").html(ajax_debug_clear(e)),jQuery("#"+r+"_city_ID").next().find("button").show().next().hide(),window.check_regional_required_fields()}})};for(var t=Object.values(evo_regional_config),n=0;n<t.length;n++)!function(){var e=t[n];window.check_regional_required_fields(e.prefix),jQuery("#"+e.prefix+"_ctry_ID").change(function(){window.load_regions(jQuery(this).val(),0,e.prefix)}),jQuery("#"+e.prefix+"_rgn_ID").change(function(){window.load_subregions(jQuery("#"+e.prefix+"_ctry_ID").val(),jQuery(this).val(),e.prefix)}),jQuery("#"+e.prefix+"_subrg_ID").change(function(){window.load_cities(jQuery("#"+e.prefix+"_ctry_ID").val(),jQuery("#"+e.prefix+"_rgn_ID").val(),jQuery(this).val(),e.prefix)}),jQuery("#button_refresh_region").click(function(){return window.load_regions(jQuery("#"+e.prefix+"_ctry_ID").val(),0,e.prefix),!1}),jQuery("#button_refresh_subregion").click(function(){return window.load_subregions(jQuery("#"+e.prefix+"_ctry_ID").val(),jQuery("#"+e.prefix+"_rgn_ID").val(),e.prefix),!1}),jQuery("#button_refresh_city").click(function(){return window.load_cities(jQuery("#"+e.prefix+"_ctry_ID").val(),jQuery("#"+e.prefix+"_rgn_ID").val(),jQuery("#"+e.prefix+"_subrg_ID").val(),e.prefix),!1})}()}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_comment_funcs_config){var p=evo_comment_funcs_config,g=new Array,d=new Array,l=p.displayed,t=!1;window.isDefined=function(e){return void 0!==e},window.fadeIn=function(e,t){if(0!=jQuery(e).length){"TR"==jQuery(e).get(0).tagName&&(e+=" td");var n=jQuery(e).css("backgroundColor");return jQuery(e).animate({backgroundColor:t},200),n}},window.fadeInStatus=function(e,t){switch(t){case"published":return fadeIn(e,"#99EE44");case"community":return fadeIn(e,"#2E8BB9");case"protected":return fadeIn(e,"#FF9C2A");case"review":return fadeIn(e,"#CC0099");case"deprecated":return fadeIn(e,"#656565");case"deleted":return fadeIn(e,"#fcc");case"spam":return fadeIn(e,"#ffc9c9");case"notsure":return fadeIn(e,"#bbbbbb");case"ok":return fadeIn(e,"#bcffb5")}},window.delete_comment_url=function(e){var t="#commenturl_"+e;fadeIn(t,"#fcc"),jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:{blogid:p.blog_ID,commentid:e,action:"delete_comment_url",crumb_comment:p.crumb_comment},success:function(e){jQuery(t).remove()}})},window.show_modified=function(){for(var e in g)fadeInStatus("#"+e,g[e])},window.setCommentStatus=function(e,t,o,n){var i="comment_"+e,a="[id="+i+"]";if(void 0===g[i]){g[i]=t;var s=fadeInStatus(a,t),r=get_show_statuses(),_=get_expiry_status(),d=get_current_page(),l=get_itemid(),u=get_limit(),c={blogid:p.blog_ID,commentid:e,status:t,limit:u,action:"set_comment_status",request_from:o,moderation:"commentlist",statuses:r,expiry_status:_,itemid:l,currentpage:d,redirect_to:n,crumb_comment:p.crumb_comment};p.is_admin_page&&(c.is_backoffice=1),jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:c,success:function(e){if(delete g[i],"front"==o){fadeIn(a,s);var t=ajax_debug_clear(e).split(":"),n=t[0];if(""==n)return;var r=jQuery(a).attr("class");r=r.replace(/vs_([a-z]+)/g,"vs_"+n),jQuery(a).attr("class",r),update_moderation_buttons(a,t[1],t[2])}else"dashboard"==o||"coll_settings"==o?updateCommentsList(i):(jQuery("#comments_container").html(ajax_debug_clear(e)),jQuery(".vote_spam").show(),show_modifieds())},error:function(e){e&&""!=e.statusText&&evoAlert(e.statusText),fadeIn(a,s),delete g[i]}})}},jQuery(".vote_spam").show(),window.setCommentVote=function(t,n,e){var r="#comment_"+t,o=fadeInStatus(r,e),i="";switch(e){case"spam":i=p.button_class_button_red;break;case"ok":i=p.button_class_button_green}var a={blog:p.blog_ID,commentid:t,type:n,vote:e,action:"set_comment_vote",b2evo_icons_type:p.b2evo_icons_type,crumb_comment:p.crumb_comment};p.is_admin_page&&(a.is_backoffice=1),""!=i&&jQuery("#vote_"+n+"_"+t).find(p.button_class_button).addClass(i),jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:a,success:function(e){fadeIn(r,o),jQuery("#vote_"+n+"_"+t).after(ajax_debug_clear(e)),jQuery("#vote_"+n+"_"+t).remove()}})},window.edit_comment=function(e,t){var n=jQuery("#editable_comment_"+t);if(0==n.length)return!0;var r="";if("update"==e){var o=n.find("textarea");if(0==o.length)return;r=o.val()}return jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:{commentid:t,action:"edit_comment",comment_action:e,comment_content:r,crumb_comment:p.crumb_comment},success:function(e){n.html(ajax_debug_clear(e)),window.init_autocomplete_usernames&&init_autocomplete_usernames()}}),!1},window.deleteComment=function(e,n,r){if(void 0===r&&(r="feedback"),"meta"==r&&!confirm(p.delete_confirmation_msg))return!1;var o="comment_"+e,i="#"+o;if(void 0===g[o]){g[o]="deleted";var t=fadeIn(i,"#fcc"),a=get_show_statuses(),s=get_expiry_status(),_=get_itemid(),d=get_current_page(),l=get_limit();if("meta"!=r){var u=jQuery("#recycle_bin");0<u.length&&""==u.html()&&jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:{action:"get_opentrash_link",blog:p.blog_ID,request_from:n,crumb_comment:p.crumb_comment},success:function(e){u.replaceWith(ajax_debug_clear(e))}})}jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:{blogid:p.blog_ID,commentid:e,action:"delete_comment",request_from:n,itemid:_,comment_type:r,statuses:a,expiry_status:s,currentpage:d,limit:l,crumb_comment:p.crumb_comment},success:function(e){var t="meta"==r?"#comments":"#recycle_bin";jQuery(i).transfer({to:t,duration:700},function(){delete g[o],"dashboard"==n||"coll_settings"==n?updateCommentsList(o):(jQuery("#comments_container").html(ajax_debug_clear(e)),jQuery(".vote_spam").show(),show_modifieds())})},error:function(e){e&&""!=e.statusText&&evoAlert(e.statusText),""!=t&&fadeIn(i,t),delete g[o]}})}},window.ban_url=function(e){openModalWindow('<span class="loader_img loader_ban_url absolute_center" title="'+p.loading_msg+'"></span><iframe id="modal_window_frame_ban" src="'+p.admin_url+"?ctrl=antispam&action=ban&display_mode=js&mode=iframe&request=checkban&keyword="+e+"&crumb_antispam="+p.crumb_antispam+'" width="100%" height="500px" frameborder="0" style="display:none"></iframe>',"90%","",!0,p.confirm_ban_delete_title,[p.perform_selected_operations_msg,"btn-danger","#antispam_ban"],!0,!1,"modal_window_frame_ban");var t=jQuery(".modal-footer button:submit").not("[data-dismiss=modal]");t.on("click",function(){addSpinner(this)}),jQuery("#modal_window_frame_ban").on("load",function(){t.hasClass("btn-spinner")&&(t.removeClass("btn-spinner"),t.css("width","-=24px"))})},window.refreshAfterBan=function(e){for(var t=String(e).split(","),n=0;n<t.length;++n)fadeIn("#comment_"+t[n],"#fcc");var r=get_itemid();refresh_item_comments(r)},window.closedModalAfterBan=function(){jQuery("#server_messages").html("").append(jQuery("#modal_window_frame_ban").contents().find(".action_messages")),closeModalWindow()},window.processResult=function(e,t){var n=jQuery("<div/>");n.html(e);var r=0;for(var o in d){var i=n.find("#"+d[o]);0!==i.length&&(i.remove(),n.find(".hidden_comment:first").removeClass("hidden_comment"),r+=1)}d.length=0,jQuery("#comments_container").html(n.html());var a=jQuery("#comments_container [id^=comment_]");for(var o in l=a?a.length:0,t)switch(t[o]){case"published":jQuery("#"+o).css("backgroundColor","#339900");break;case"deprecated":jQuery("#"+o).css("backgroundColor","#656565");break;case"deleted":jQuery("#"+o).css("backgroundColor","#fcc")}var s=jQuery("#new_badge").val();if("0"==s)jQuery("#comments_block").effect("blind",{},200),jQuery("#comments_block").remove();else{var _=parseInt(s)-r;jQuery("#badge").text(_)}},window.refreshComments=function(e){t||(t=!0,jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:{blogid:p.blog_ID,action:"refresh_comments",request_from:e,crumb_comment:p.crumb_comment},success:function(e){processResult(ajax_debug_clear(e),g),jQuery("#comments_container").slideDown("fast"),jQuery(".vote_spam").show(),t=!1},error:function(e){e&&""!=e.statusText&&evoAlert(e.statusText),t=!1}}))},window.startRefreshComments=function(e,t,n,r){"dashboard"==e||"coll_settings"==e?jQuery("#comments_container").slideUp("fast",refreshComments(e)):jQuery("#comments_container").fadeTo("slow",.1,function(){refresh_item_comments(t,n,r)})},window.endRefreshComments=function(e){jQuery("#comments_container").html(e),jQuery("#comments_container").fadeTo("slow",1),jQuery(".vote_spam").show()},window.get_current_page=function(){return isDefined(jQuery("#currentpage"))&&isDefined(jQuery("#currentpage").attr("value"))?jQuery("#currentpage").attr("value"):1},window.get_limit=function(){var e=jQuery("select[name$=_per_page]");return isDefined(e)?e.val():0},window.get_show_statuses=function(){return jQuery("#only_moderation")&&jQuery("#only_moderation").is(":checked")?"#only_moderation#":jQuery("#only_valid")&&jQuery("#only_valid").is(":checked")?"#only_valid#":"#all#"},window.get_expiry_status=function(){var e="active";return jQuery("#show_expiry_all")&&jQuery("#show_expiry_all").prop("checked")&&(e="all"),e},window.get_itemid=function(){var e=jQuery("#comments_container").attr("value");return isDefined(e)||(e=-1),e},window.refresh_item_comments=function(e,t,n){var r=get_show_statuses(),o=get_expiry_status();isDefined(t)||(t=get_current_page()),isDefined(e)||(e=-1),void 0===n&&(n="feedback"),jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:{blogid:p.blog_ID,action:"refresh_comments",request_from:p.request_from,itemid:e,statuses:r,expiry_status:o,currentpage:t,comment_type:n},success:function(e){endRefreshComments(ajax_debug_clear(e)),show_modifieds()},error:function(e){e&&""!=e.statusText&&evoAlert(e.statusText)}})},window.decrease_comments_number=function(e){var t=parseInt(jQuery("#badge").text());t&&(t-=e,jQuery("#badge").text(t))},window.updateCommentsList=function(e){--l,decrease_comments_number(1),jQuery("#"+e).remove(),jQuery(".hidden_comment:first").removeClass("hidden_comment"),t&&d.push(e),jQuery(".dashboard_post:visible").removeClass("dashboard_post_odd dashboard_post_even"),jQuery(".dashboard_post:visible:even").addClass("dashboard_post_even"),jQuery(".dashboard_post:visible:odd").addClass("dashboard_post_odd"),l<6&&refreshComments("dashboard")},window.update_moderation_buttons=function(e,t,n){var r=p.button_class_group;void 0!==e&&(r=e+" "+r),e=r+p.button_class_text,jQuery(e).removeClass("first-child last-child btn_next_status"),jQuery(e+".btn_raise_status_"+t).addClass("btn_next_status"),jQuery(e+".btn_lower_status_"+n).addClass("btn_next_status"),jQuery(e+":visible:first").addClass("first-child"),jQuery(e+":visible:last").addClass("last-child")}}}),jQuery(document).ready(function(){if("undefined"!=typeof evo_user_funcs_config){var n=evo_user_funcs_config;window.userfield_criteria_autocomplete=function(e){if(0<e.find("option:selected[rel=suggest]").length){var n=e.val();e.nextAll("input").first().autocomplete({source:function(e,t){jQuery.getJSON(htsrv_url+"anon_async.php?action=get_user_field_autocomplete",{term:e.term,attr_id:n},t)}})}else e.nextAll("input").first().autocomplete().autocomplete("destroy")},jQuery(document).on("change","select[id^=criteria_type]",function(){window.userfield_criteria_autocomplete(jQuery(this))});for(var e=0;e<jQuery("select[id^=criteria_type]").length;e++)window.userfield_criteria_autocomplete(jQuery("select[id^=criteria_type]:eq("+e+")"));n.can_edit_user_level&&jQuery(".user_level_edit").each(function(){0==jQuery(this).find("a").length&&jQuery(this).removeClass("user_level_edit")}),window.merge_duplicated_users=function(e){var t=jQuery("[name=selected_user_ID]:checked");return 0==t.length?alert(n.msg_select_remaining_account):location.href=jQuery(e).attr("href")+"&selected_user_ID="+t.val(),!1}}}),b2evo_Callbacks.prototype={register_callback:function(e,t,n){void 0===this.eventHandlers[e]&&(this.eventHandlers[e]=new Array),void 0!==n&&n?this.eventHandlers[e][0]=t:this.eventHandlers[e][this.eventHandlers[e].length]=t},trigger_callback:function(event,args){if(void 0===this.eventHandlers[event])return null;for(var r=!1,cb_args="",cb_arguments=arguments,i=1;i<arguments.length;i++)cb_args+="cb_arguments["+i+"], ";cb_args.length&&(cb_args=cb_args.substring(0,cb_args.length-2));for(var i=0;i<this.eventHandlers[event].length;i++){var f=this.eventHandlers[event][i];r=eval("f("+cb_args+");")||r}return r}};var b2evo_Callbacks=new b2evo_Callbacks;function evoAlert(e){var t=jQuery(".b2evo_alert");0<t.length&&t.remove(),jQuery("body").append('<div class="b2evo_alert">'+e+"</div>"),setTimeout(function(){jQuery(".b2evo_alert").fadeOut({complete:function(){jQuery(this).remove()}})},3e3),evo_alert_events_initialized||(evo_alert_events_initialized=!0,jQuery(document).on("click",".b2evo_alert",function(){jQuery(this).remove()}))}function debounce(o,i,a){var s,_;return function(){var e,t,n=this,r=arguments;return e=function(){s=null,a||(_=o.apply(n,r))},t=a&&!s,clearTimeout(s),s=setTimeout(e,i),t&&(_=o.apply(n,r)),_}}function ajax_debug_clear(e){return e=(e=e.replace(/<!-- Ajax response end -->/,"")).replace(/(<div class="jslog">[\s\S]*)/i,""),jQuery.trim(e)}function ajax_response_is_correct(e){return!!e.match(/<!-- Ajax response end -->/)&&""!=(e=ajax_debug_clear(e))}function SendAdminRequest(e,t,n,r){void 0!==r&&!r||(n+=(""!==n?"&":"")+"nocache_dummy="+(new Date).getTime());SendServerRequest(b2evo_dispatcher_url+"?ctrl="+e+"&action="+t+(n?"&"+n:""))}function SendServerRequest(e){e+=-1!=e.indexOf("?")?"&":"?";var t=(e+="display_mode=js").split("?");e=t[0],t=t[1],jQuery.ajax({type:"POST",url:e,data:t,dataType:"script",success:function(){-1<t.indexOf("ctrl=widgets")&&"function"==typeof window.top.evo_customizer_reload_frontoffice&&window.top.evo_customizer_reload_frontoffice()}})}function AttachServerRequest(e){jQuery('<input type="hidden" name="display_mode" value="js" /><input type="hidden" name="js_target" value="window.parent." />').appendTo("#"+e),jQuery("#"+e).attr("target","server_postback")}function DisplayServerMessages(e,t){jQuery("#server_messages").html(e),"object"==typeof t&&(jQuery("input.field_error, select.field_error, textarea.field_error").each(function(){jQuery(this).removeClass("field_error");var e=jQuery(this).next();e.hasClass("notes")&&"SPAN"==e.get(0).tagName&&e.remove()}),jQuery.each(t,function(e,t){jQuery("#"+e).addClass("field_error").after('<span class="oneline notes"> <span class="field_error" rel="'+e+'">'+t+"</span></span>")})),jQuery("#server_messages .log_success").animate({backgroundColor:"#88ff88"},"fast").animate({backgroundColor:"#ffffff"},"fast","",function(){jQuery(this).removeAttr("style")}),jQuery("#server_messages > .log_error").animate({backgroundColor:"#ff8888"},"fast").animate({backgroundColor:"#ffffff"},"fast","",function(){jQuery(this).removeAttr("style")})}evo_alert_events_initialized=!1,jQuery(document).ready(function(){function n(e){var t=e.data("prefix")?e.data("prefix"):"",n=jQuery("."+t+e.val()+"_toolbar");if(0==n.length)return!0;e.is(":checked")?(n.removeClass("disabled"),n.find("input[type=button]").prop("disabled",!1)):(n.addClass("disabled"),n.find("input[type=button]").prop("disabled",!0))}jQuery(document).on("click","[data-func]",function(){var e=jQuery(this).data("func").match(/([^\\|]|\\\|)+/g),t=e[0];e.splice(0,1);for(var n=0;n<e.length;n++)-1<e[n].indexOf("b2evoCanvas")?e[n]=window[e[n]]:" "==e[n]?e[n]="":e[n]=e[n].replace(/\\\|/g,"|");return 0<jQuery(this).closest(".disabled[class*=_toolbar]").length||window[t].apply(null,e),!1}),jQuery('input[type=checkbox][name="renderers[]"]').each(function(){n(jQuery(this))}),jQuery('input[type=checkbox][name="renderers[]"]').on("click",function(){n(jQuery(this))}),jQuery(".plugin-toolbar").on("click",function(){if(jQuery(this).hasClass("disabled")){var e=jQuery(this).attr("data-plugin-toolbar");if(e){if(0===(e=e.replace("_toolbar","")).indexOf("meta_")){e=e.replace("meta_","");var t=jQuery('input[type=checkbox][id="meta_renderer_'+e+'"]')}else t=jQuery('input[type=checkbox][id="renderer_'+e+'"]');0<t.length&&(t.prop("checked",!0),n(t))}}})}),jQuery(document).ready(function(){jQuery(".pblock").length?jQuery('<div id="server_messages"></div>').prependTo(".pblock"):jQuery(".level2").length?jQuery(".level2").after('<div id="server_messages"></div>'):jQuery(".navbar.level1").after('<div id="server_messages"></div>'),jQuery('<iframe id="server_postback" name="server_postback"></iframe>').appendTo("body").css({position:"absolute",left:"-1000em",top:"-1000em"})});var _b2evoCommunications=function(){var n,r,t=2500,o=250;return{Init:function(){var e=jQuery.fn.extend({delay:t,interval:o,dispatcher:r},arguments.length?arguments[0]:"");t=e.delay,o=e.interval,r=e.dispatcher,n=this,b2evoHelper.info("Communications object ready")},BufferedServerCall:function(){var e=jQuery.fn.extend({ticker_callback:function(){return!0},send_callback:function(){},delay:t,interval:o,buffer_name:""},arguments.length?arguments[0]:"");if(ticker_status=e.ticker_callback(e.delay))switch(!0!==ticker_status&&b2evoHelper.log("Ticker status : "+ticker_status),ticker_status){case"cancel":return void b2evoHelper.DisplayMessage('<div class="log_message">'+T_("Update cancelled")+"</div>");case"pause":return b2evoHelper.DisplayMessage('<div class="log_error">'+T_("Update Paused")+" : "+b2evoHelper.str_repeat(".",e.delay/e.interval)+"</div>"),void n.BufferedServerLoop(e);case"ignore":return void n.BufferedServerLoop(e);case"immediate":break;default:if(e.delay-=e.interval,0<e.delay)return b2evoHelper.DisplayMessage('<div class="log_error">'+T_("Changes pending")+" : "+b2evoHelper.str_repeat(".",e.delay/e.interval)+"</div>"),void n.BufferedServerLoop(e);b2evoHelper.DisplayMessage('<div class="log_message">'+T_("Saving changes")+"</div>"),e.send_callback()}},BufferedServerLoop:function(e){var t=jQuery(n).data("buffers");void 0===t&&(t=Array()),t[e.buffer_name]=e,jQuery(n).data("buffers",t),window.setTimeout('b2evoCommunications.BufferedServerCallback( "'+e.buffer_name+'" )',e.interval)},BufferedServerCallback:function(e){var t=jQuery(n).data("buffers");n.BufferedServerCall(t[e])},SendAdminRequest:function(){var e=jQuery.fn.extend({ctrl:"",action:"",data:"",key:"",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:""),t="ctrl="+e.ctrl+"&key="+e.key+"&action="+e.action+"&"+e.data;n.SendServerRequest({url:r,data:t,error:e.error,ok:e.ok})},SendServerRequest:function(){var e=jQuery.fn.extend({url:"",data:"",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:"");if(e.url){e.url+=(!0===e.url.indexOf("?")?"&":"?")+"mode=js",e.data&&(e.url+="&"+e.data);var t=jQuery("<script><\/script>");t.attr("src",e.url),t.load(e.ok()),t.error(e.error()),t.appendTo("body"),b2evoHelper.log("Sending request : "+e.url)}}}},b2evoCommunications=new _b2evoCommunications;function get_form(e){for(;"FORM"!=e.tagName;){if(void 0===e)return!1;e=e.parentNode}return e}function check(e,t){if(form_obj=get_form(e),!form_obj)return alert("Could not find form"),!1;for(i=0;i<form_obj.length;)"checkbox"==form_obj.elements[i].type&&(form_obj.elements[i].checked=t),i++;return!1}function check_all(e){return target=findTarget(e),check(target,!0),cancelClick(e),!1}function uncheck_all(e){return target=findTarget(e),check(target,!1),cancelClick(e),!1}function cancelClick(e){return window.event&&window.event.returnValue&&(window.event.returnValue=!1),e&&e.preventDefault&&e.preventDefault(),!1}function surround_check(e,t,n){var r=findTarget(e);for(el_form=get_form(r),el_inputs=el_form.getElementsByTagName("INPUT"),i=0;i<el_inputs.length;i++)el_input=el_inputs[i],"checkbox"==el_input.type&&(null!=n&&el_input.checked!=n||(el_input.parentNode.className=t))}function surround_unchecked(e){surround_check(e,"checkbox_surround",!1)}function surround_checked(e){surround_check(e,"checkbox_surround",!0)}function unsurround_all(e){surround_check(e,"checkbox_surround_init",null)}function init_check_all(){for(var e=document.getElementsByName("check_all_nocheckchanges"),t=0;t<e.length;t++){var n=e[t];jQuery(n).bind({click:check_all,mouseover:surround_unchecked,mouseout:unsurround_all})}var r=document.getElementsByName("uncheck_all_nocheckchanges");for(t=0;t<r.length;t++){n=r[t];jQuery(n).bind({click:uncheck_all,mouseover:surround_checked,mouseout:unsurround_all})}}function clear_form(e){for(e=check(e,!1),i=0;i<e.length;)"text"==e.elements[i].type&&(e.elements[i].value=""),i++;return e}function focus_on_first_input(){if(all_inputs=document.getElementsByTagName("input"),all_inputs.length)for(i=0;i<all_inputs.length;i++)if("text"==all_inputs[i].type&&1!=all_inputs[i].disabled){try{all_inputs[i].focus()}catch(e){}break}}function check_combo(e){var t=jQuery(e),n=t.next();t.find("option:first").is(":selected")?(n.show().focus(),"required"==t.attr("required")&&n.attr("required","required")):(n.hide(),n.removeAttr("required"))}function input_decorated_help(e,t){function n(){""!=r.value&&r.value!=t||(r.style.color="#666",r.value=t)}var r=document.getElementById(e);jQuery(r).bind("blur",n),jQuery(r).bind("focus",function(){r.style.color="",r.value==t&&(r.value="")}),jQuery(r.form).bind("submit",function(){r.value==t&&(r.value="")}),n()}function findTarget(e){var t;if(window.event&&window.event.srcElement?t=window.event.srcElement:e&&e.target&&(t=e.target),!t)return null;for(;t!=document.body&&"a"!=t.nodeName.toLowerCase();)t=t.parentNode;return"a"!=t.nodeName.toLowerCase()?null:t}function addSpinner(e){(e=jQuery(e)).addClass("btn-spinner"),e.css("width","+=24px")}function checkInputLength(e,t,n){e.value.length<t?e.setCustomValidity(n):e.setCustomValidity("")}function check_extracat(e){for(var t=e.value,n=document.getElementsByName("post_extracats[]"),r=0;r<n.length;r++){var o=n[r];o.value==t&&(o.checked=!0)}}function init_dynamicSelect(){for(var e=0;e<nb_dynamicSelects;e++)dynamicSelect(tab_dynamicSelects[e].parent,tab_dynamicSelects[e].child)}function dynamicSelect(e,t){if(document.getElementById&&document.getElementsByTagName){var n=document.getElementById(e),r=document.getElementById(t),o=r.cloneNode(!0).getElementsByTagName("option");refreshDynamicSelectOptions(n,r,o),n.onchange=function(){refreshDynamicSelectOptions(n,r,o)}}}function refreshDynamicSelectOptions(e,t,n){for(;t.options.length;)t.remove(0);for(var r=new RegExp("^"+e.options[e.selectedIndex].value+"-.*$"),o=0;o<n.length;o++)!n[o].value.match(r)&&""!=n[o].value||t.appendChild(n[o].cloneNode(!0))}function evoFadeSuccess(e){evoFadeBg(e,new Array("#ddff00","#bbff00"))}function evoFadeFailure(e){evoFadeBg(e,new Array("#9300ff","#ff000a","#ff0000"))}function evoFadeHighlight(e){evoFadeBg(e,new Array("#ffbf00","#ffe79f"))}function evoFadeBg(selector,bgs,options){var origBg=jQuery(selector).css("backgroundColor"),speed=options&&options.speed||'"slow"',toEval="jQuery(selector).animate({ backgroundColor: ";for(e in bgs)"string"==typeof bgs[e]&&(toEval+='"'+bgs[e]+'"}, '+speed+" ).animate({ backgroundColor: ");toEval+="origBg }, "+speed+', "", function(){jQuery( this ).css( "backgroundColor", "" );});',eval(toEval)}function evobarFlash(bgs,options){var evobar="#evo_toolbar",menus="#evo_toolbar .evobar-menu a",origBg=jQuery(evobar).css("backgroundColor");jQuery(menus).css("backgroundColor","inherit");var speed=options&&options.speed||'"fast"',toEval="jQuery( evobar ).animate({ backgroundColor: ";for(e in bgs)"string"==typeof bgs[e]&&(toEval+='"'+bgs[e]+'"}, '+speed+" ).animate({ backgroundColor: ");toEval+="origBg }, "+speed+', "", function(){ jQuery( this ).css( "backgroundColor", "" ); jQuery( menus ).css( "backgroundColor", "" ); } );',eval(toEval)}function b2edit_open_preview(e,t,n){var r=jQuery(e);if(0==r.length)return location.href=t,!1;if("b2evo_preview"==r.attr("target"))return!1;null!=typeof n&&!0===n&&r.find("input[name=preview_block]").val("1");var o=r.attr("action");return r.attr("action",t),r.attr("target","b2evo_preview"),preview_window=window.open("","b2evo_preview"),preview_window.focus(),r.submit(),r.attr("action",o),r.attr("target","_self"),r.find("input[name=preview_block]").val("0"),!1}function b2edit_reload(e,t,n,r,o){var i=jQuery(e);if(0==i.length||0==i.find("input[type=hidden][name^=crumb_]").length)return location.href=t,!1;i.attr("action",t);if((0<i.find('[name="actionArray[update]"]').length?i.append('<input type="hidden" name="action" value="edit_switchtab" />'):0<i.find('[name="actionArray[create]"]').length?i.append('<input type="hidden" name="action" value="new_switchtab" />'):i.append('<input type="hidden" name="action" value="switchtab" />'),!0)&&void 0!==r)for(param in r)i.append('<input type="hidden" name="'+param+'" value="'+r[param]+'" />');return void 0!==n&&"undefined"!=n&&(null==n&&(n=""),i.find('[name="blog"]').val(n)),window.onbeforeunload=null,void 0!==o&&1==o&&i.reset(),i.submit(),!1}function b2edit_type(e,t,n){var r=!1;return 0<bozo.nb_changes&&(r=!confirm(e)),b2edit_reload("#item_checkchanges",t,null,{action:n},r)}function b2edit_confirm(e,t,n){return!(0<bozo.nb_changes&&!confirm(e))&&b2edit_reload("#item_checkchanges",t,null,{action:n},!1)}function get_whois_info(t){var n=jQuery(window).height()-40;return openModalWindow('<span id="spinner" class="loader_img loader_user_report absolute_center" title="'+evo_js_lang_whois_title+'"></span>',"90%",n+"px",!0,"WHOIS - "+t,!0,!0),jQuery.ajax({type:"GET",url:htsrv_url+"async.php",data:{action:"get_whois_info",query:t,window_height:n},success:function(e){ajax_response_is_correct(e)&&openModalWindow(e=ajax_debug_clear(e),"90%",n+"px",!0,"WHOIS - "+t,!0)}}),!1}function b2template_list_highlight(e){var t=jQuery(e),n=t.prevAll("select").find(":selected").val(),r=t.attr("href");return n&&(r+="&highlight="+n),window.self!==window.top?window.top.location=r:window.location=r,!1}function evo_copy_to_clipboard(e){var t=document.createRange();return t.selectNode(document.getElementById(e)),window.getSelection().removeAllRanges(),window.getSelection().addRange(t),document.execCommand("copy"),window.getSelection().removeAllRanges(),evoFadeBg("#"+e,new Array("#ffbf00"),{speed:100}),!1}jQuery(document).on("change",".btn-file :file",function(){var e=jQuery(this).val().replace(/\\/g,"/").replace(/.*\//,"");jQuery(this).parent().next().html(e)});var current_widgets="",reorder_widgets_queue,reorder_delay=200,reorder_delay_remaining=0;function makeDragnDrop(e){makeDraggable(e),makeDroppable(e)}function makeDraggable(e){jQuery(e).draggable({helper:"clone",scroll:!0,scrollSensitivity:100,zIndex:999,opacity:.8,cursor:"move",cancel:"input,textarea,button,select,option,a,span.fa,span.widget_checkbox",start:function(){jQuery(this).hide()},stop:function(){jQuery(this).show()}}).addClass("draggable_widget")}function makeDroppable(e){jQuery(e).droppable({accept:".draggable_widget",hoverClass:"droppable-hover",greedy:!0,tolerance:"pointer",delay:1e3,drop:function(e,t){jQuery(".fade_me").removeClass("fade_me"),jQuery(".available_widgets").removeClass("available_widgets_active"),jQuery(this).hasClass("available_widgets")?jQuery(t.draggable).hasClass("new_widget")||jQuery(t.draggable).remove():jQuery(t.draggable).hasClass("new_widget")?addNewWidget(t.draggable,this):(jQuery(t.draggable).insertAfter(this),jQuery(t.draggable).addClass("fade_me server_update"),jQuery(t.draggable).droppable("enable")),doFade(".fade_me"),colourWidgets(),sendWidgetOrder()}})}function doFade(e){jQuery(e).addClass("evo_highlight"),setTimeout(function(){jQuery(e).removeClass("evo_highlight")},5e3)}function sendWidgetOrder(){reorder_delay_remaining<1&&jQuery("#server_messages").html('<div class="log_container"><div class="log_error"></div></div>'),reorder_delay_remaining=reorder_delay,bufferedServerCall()}function sendWidgetOrderCallback(e){doFade(".server_updating"),jQuery(".server_updating").removeClass("server_updating"),colourWidgets()}function bufferedServerCall(){var e=getWidgetOrder();e!=current_widgets?(jQuery("#server_messages").html('<div class="action_messages container-fluid"><ul><li><div class="alert alert-dismissible alert-info fade in">'+T_("Saving changes")+"</div></li></ul></div>"),current_widgets=e,e+="&"+widget_crumb_url_param,jQuery(".pending_update").removeClass("pending_update").addClass("server_updating"),jQuery("input[type=hidden][name=wico_ID]").length&&(e+="&wico_ID="+jQuery("input[type=hidden][name=wico_ID]").val()),SendAdminRequest("widgets","re-order",e,!1)):(jQuery("#server_messages").html('<div class="action_messages container-fluid"><ul><li><div class="alert alert-dismissible alert-warning fade in">'+T_("Widget order unchanged")+"</div></li></ul></div>"),jQuery(".pending_update").removeClass("pending_update"),colourWidgets())}function getWidgetOrder(){var t=new Array;jQuery(".widget_container").each(function(){var e=jQuery(this).attr("id");t[e]="",jQuery("#"+e+" .draggable_widget").each(function(){jQuery(this).attr("id")&&"undefined"!=jQuery(this).attr("id")&&(t[e]+=jQuery(this).attr("id")+", ")})});var e="",n="";for(container in t)e+=container+"="+t[container]+"&",n+=container+",";return("undefined"!=typeof blog_id?"blog="+blog_id:"")+"&"+e+"container_list="+n}function colourWidgets(){jQuery(".draggable_widget").removeClass("odd"),jQuery(".draggable_widget").removeClass("even");var e=!1;jQuery("#current_widgets .draggable_widget").each(function(){e=!e,jQuery(this).addClass(e?"even":"odd")})}function deleteWidget(e){return jQuery("#wi_ID_"+e.substr(6,e.length)).animate({backgroundColor:"#f88"},"fast",function(){jQuery(this).remove(),colourWidgets(),sendWidgetOrder()}),!1}function duplicateWidget(e,t){var n="wi_ID="+e.substr(6,e.length)+"&"+widget_crumb_url_param;return"customizer"==t&&(n+="&mode=customizer"),SendAdminRequest("widgets","duplicate",n,!0),!1}function editWidget(e){return jQuery("#server_messages").html(""),msg="wi_ID="+e.substr(6,e.length)+"&"+widget_crumb_url_param,SendAdminRequest("widgets","edit",msg,!0),!1}function widgetSettings(e,t,n){jQuery("body").append('<div id="screen_mask" onclick="closeWidgetSettings()"></div><div id="widget_settings" class="modal-content"></div>'),jQuery("#screen_mask").fadeTo(1,.5).fadeIn(200),jQuery("#widget_settings").html(e).addClass("widget_settings_active edit_widget_"+t+"_"+n),jQuery("#widget_settings").prepend(jQuery("#server_messages")),AttachServerRequest("widget_checkchanges");var r=jQuery("#widget_settings").find("form > h2.page-title:first");if(0<r.length){var o=r.parent().children("span.global_icons"),i="";0<o.length&&(o.find("a.close_link").remove(),i='<span class="pull-right">'+o.html()+"</span>",o.remove()),jQuery("#widget_settings").prepend('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'+i+'<h4 class="modal-title">'+r.html()+"</h4></div>"),r.remove(),jQuery("#widget_settings button.close").bind("click",closeWidgetSettings)}jQuery("#widget_settings a.close_link").bind("click",closeWidgetSettings)}function widgetSettingsCallback(e,t,n){jQuery("#wi_ID_"+e+" .widget_name").html(t),jQuery("#wi_ID_"+e+" .widget_cache_status").html(getWidgetCacheIcon("wi_ID_"+e,n))}function closeWidgetSettings(e){if(!jQuery("#widget_settings").is(":visible"))return!1;if("undefined"!=typeof bozo&&(void 0===e||"update"!=e)){if(bozo.validate_close()&&!confirm(bozo.validate_close()))return!1;bozo.reset_changes()}return jQuery("#widget_settings").hide(),jQuery("#server_messages").insertBefore(".available_widgets"),jQuery("#widget_settings").remove(),jQuery("#screen_mask").remove(),!1}function showMessagesWidgetSettings(e){return void 0!==e&&"success"==e&&"undefined"!=typeof bozo&&bozo.reset_changes(),jQuery("#widget_settings").animate({scrollTop:jQuery("#widget_settings").scrollTop()+ +jQuery("#server_messages").position().top-20},100),!1}function T_(e){return void 0===T_arr[e]?e:T_arr[e]}function convertAvailableList(){jQuery(".fieldset_title > span > a[id^='add_new']").attr("href","#").bind("click",function(e){jQuery("body").append('<div id="screen_mask" onclick="closeAvailableWidgets()"></div>'),jQuery("#screen_mask").fadeTo(1,.5).fadeIn(200),offset=jQuery(this).offset();var t=offset.top,n=jQuery(document).height()-10-jQuery(".available_widgets").height();return n<20&&(n=20),n<t&&(t=n),jQuery(".available_widgets").addClass("available_widgets_active").attr("id","available_"+jQuery(this).attr("id")),!1}),jQuery(".available_widgets_toolbar > a").bind("click",function(e){return closeAvailableWidgets(),!1}),jQuery(".available_widgets li").each(function(){jQuery(this).addClass("new_widget");var e=jQuery(this).children("a").attr("href");e=e.substr(e.indexOf("&type")+1,e.length),jQuery(this).children("a").attr("href","#").bind("click",function(){return addNewWidget(this,e),!1})})}function closeAvailableWidgets(){if(!jQuery(".available_widgets").is(":visible"))return!1;jQuery(".available_widgets").removeClass("available_widgets_active"),jQuery("#screen_mask").remove()}function addNewWidget(e,t){closeAvailableWidgets();var n=jQuery(e).attr("id");jQuery(e).attr("id",n);var r=jQuery(".available_widgets").attr("id");r=r.substr(18,r.length),SendAdminRequest("widgets","create",t+"&blog="+blog_id+"&container="+r,!0)}function addNewWidgetCallback(e,t,n,r,o,i,a,s,_){jQuery(".fade_me").removeClass("fade_me"),createWidget("wi_ID_"+e,t.replace(/ /g,"_").replace(/:/g,"-"),n,r,"",o,i,a,s,_),doFade("#wi_ID_"+e),0<reorder_delay_remaining?reorder_delay_remaining=0:current_widgets=getWidgetOrder()}function createWidget(e,t,n,r,o,i,a,s,_,d){var l=jQuery('<li id="'+e+'" class="draggable_widget"><span class="widget_title">'+r+"</span></li>");if(l.find("a.widget_name").click(function(){return editWidget(e)}),o&&jQuery(l).addClass(o),jQuery(l).prepend(jQuery('<span class="widget_state">'+(a?disabled_plugin_tag:'<a href="#" class="toggle_action" onclick="return toggleWidget( \''+e+"' );\">"+(i?enabled_icon_tag:disabled_icon_tag)+"</a>")+"</span>")),"customizer"!=d){jQuery(l).prepend(jQuery('<span class="widget_checkbox'+(i?" widget_checkbox_enabled":"")+'"><input type="checkbox" name="widgets[]" value="'+e.replace("wi_ID_","")+'" '+(a?'disabled="disabled" ':"")+"/></span>"));var u=jQuery('<span class="widget_cache_status">'+getWidgetCacheIcon(e,s)+"</span>");jQuery(l).append(u)}var c='<span class="widget_actions">';"customizer"!=d&&(c+='<a href="#" onclick="return editWidget( \''+e+"' );\">"+edit_icon_tag+"</a>"),c+='<a href="#" onclick="return duplicateWidget( \''+e+"', '"+d+"' );\">"+duplicate_icon_tag+'</a><a href="#" onclick="return deleteWidget( \''+e+"' );\">"+delete_icon_tag+"</a></span>",c=jQuery(c),jQuery(l).append(c),_?jQuery("#container_"+t+" li#wi_ID_"+_).after(l):jQuery("#container_"+t).append(l),makeDragnDrop("#"+e),colourWidgets()}function toggleWidget(e){return SendAdminRequest("widgets","toggle","wi_ID="+e.substr(6)+"&"+widget_crumb_url_param,!0),!1}function doToggle(e,t,n){n?(jQuery("#wi_ID_"+e+" .widget_state").html(disabled_plugin_tag),jQuery("#wi_ID_"+e+" .toggle_action").css("visibility","hidden")):(jQuery("#wi_ID_"+e+" .toggle_action").css("visibility","visible"),jQuery("#wi_ID_"+e+" .widget_state").html('<a href="#" class="toggle_state" onclick="return toggleWidget( \'wi_ID_'+e+"', '"+widget_crumb_url_param+"' );\">"+(t?enabled_icon_tag:disabled_icon_tag)+"</a>")),t?jQuery("#wi_ID_"+e+" .widget_checkbox").addClass("widget_checkbox_enabled"):jQuery("#wi_ID_"+e+" .widget_checkbox").removeClass("widget_checkbox_enabled"),jQuery("#wi_ID_"+e+" .toggle_action").html(t?deactivate_icon_tag:activate_icon_tag),doFade("#wi_ID_"+e)}function toggleCacheWidget(e,t){return SendAdminRequest("widgets","cache_"+t,"wi_ID="+e.substr(6)+"&"+widget_crumb_url_param,!0),!1}function doToggleCache(e,t){jQuery("#wi_ID_"+e+" .widget_cache_status").html(getWidgetCacheIcon("wi_ID_"+e,t)),doFade("#wi_ID_"+e)}function str_repeat(e,t){return new Array(t+1).join(e)}function getWidgetCacheIcon(e,t){switch(t){case"enabled":return'<a href="#" class="cache_action" onclick="return toggleCacheWidget( \''+e+"', 'disable' );\">"+cache_enabled_icon_tag+"</a>";case"disabled":return'<a href="#" class="cache_action" onclick="return toggleCacheWidget( \''+e+"', 'enable' );\">"+cache_disabled_icon_tag+"</a>";case"disallowed":return cache_disallowed_icon_tag;case"denied":return'<a href="?ctrl=coll_settings&amp;tab=advanced&amp;blog='+blog_id+'#fieldset_wrapper_caching">'+cache_denied_icon_tag+"</a>"}}function openModalWindow(e,t,n,r,o,i){var a="overlay_page_active";void 0!==r&&1==r&&(a="overlay_page_active_transparent"),void 0===t&&(t="560px");var s="";void 0!==n&&(0<n||""!=n)&&(s=' style="height:'+n+'"'),0<jQuery("#overlay_page").length?jQuery("#overlay_page").html(e):(jQuery("body").append('<div id="screen_mask"></div><div id="overlay_wrap" style="width:'+t+'"><div id="overlay_layout"><div id="overlay_page"'+s+"></div></div></div>"),jQuery("#screen_mask").fadeTo(1,.5).fadeIn(200),jQuery("#overlay_page").html(e).addClass(a),jQuery(document).on("click","#close_button, #screen_mask, #overlay_page",function(e){if("overlay_page"!=jQuery(this).attr("id"))return closeModalWindow(),!1;var t=jQuery("#overlay_page form");if(t.length){var n=t.position().top+jQuery("#overlay_wrap").position().top,r=n+t.height();e.clientY>n&&e.clientY<r||closeModalWindow()}return!0}))}function closeModalWindow(e){return void 0===e&&(e=window.document),jQuery("#overlay_page",e).hide(),jQuery(".action_messages",e).remove(),jQuery("#server_messages",e).insertBefore(".first_payload_block"),jQuery("#overlay_wrap",e).remove(),jQuery("#screen_mask",e).remove(),!1}function user_crop_avatar(e,t,n){void 0===n&&(n="avatar");var r=750,o=jQuery(window).width(),i=jQuery(window).height(),a=i/o,s=10,_=10;s=320<(o=r<o?r:o<320?320:o)-2*s?10:0,_=320<(i=r<i?r:i<320?320:i)-2*_?10:0;var d=r<o?r:o,l=r<i?r:i;openModalWindow('<span id="spinner" class="loader_img loader_user_report absolute_center" title="'+evo_js_lang_loading+'"></span>',d+"px",l+"px",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,"btn-primary"],!0);var u=jQuery("div.modal-dialog div.modal-body").length?jQuery("div.modal-dialog div.modal-body"):jQuery("#overlay_page"),c=parseInt(u.css("paddingTop")),p=parseInt(u.css("paddingRight")),g=parseInt(u.css("paddingBottom")),f=parseInt(u.css("paddingLeft")),m=(jQuery("div.modal-dialog div.modal-body").length?parseInt(u.css("min-height")):l-100)-(c+g),v={user_ID:e,file_ID:t,aspect_ratio:a,content_width:d-(f+p),content_height:m,display_mode:"js",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(v.ctrl="user",v.user_tab="crop",v.user_tab_from=n):(v.blog=evo_js_blog,v.disp="avatar",v.action="crop"),jQuery.ajax({type:"POST",url:evo_js_user_crop_ajax_url,data:v,success:function(e){openModalWindow(e,d+"px",l+"px",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,"btn-primary"])}}),!1}function user_report(e,t){openModalWindow('<span class="loader_img loader_user_report absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,"btn-danger"],!0);var n={action:"get_user_report_form",user_ID:e,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(n.is_backoffice=1,n.user_tab=t):n.blog=evo_js_blog,jQuery.ajax({type:"POST",url:evo_js_user_report_ajax_url,data:n,success:function(e){openModalWindow(e,"auto","",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,"btn-danger"])}}),!1}function user_deldata(e,t){return openModalWindow('<span class="loader_img loader_user_deldata absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,"btn-danger"],!0),jQuery.ajax({type:"POST",url:evo_js_user_deldata_ajax_url,data:{ctrl:"user",user_tab:"deldata",user_tab_from:t,user_ID:e,display_mode:"js",crumb_user:evo_js_crumb_user},success:function(e){openModalWindow(e,"auto","",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,"btn-danger"])}}),!1}function user_add_org(e){return openModalWindow('<span class="loader_img loader_user_deldata absolute_center" title="'+evo_js_lang_loading+'"></span>',"450px","",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add,!0),jQuery.ajax({type:"POST",url:evo_js_user_org_ajax_url,data:{ctrl:"organizations",action:"add_user",org_ID:e,display_mode:"js",crumb_user:evo_js_crumb_organization},success:function(e){openModalWindow(e,"450px","",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add),jQuery("input.autocomplete_login").trigger("added")}}),!1}function user_edit(e,t){return openModalWindow('<span class="loader_img loader_user_deldata absolute_center" title="'+evo_js_lang_loading+'"></span>',"450px","",!0,evo_js_lang_edit_membership,evo_js_lang_edit,!0),jQuery.ajax({type:"POST",url:evo_js_user_org_ajax_url,data:{ctrl:"organizations",action:"edit_user",org_ID:e,user_ID:t,display_mode:"js",crumb_user:evo_js_crumb_organization},success:function(e){openModalWindow(e,"450px","",!0,evo_js_lang_edit_membership,evo_js_lang_edit)}}),!1}function user_remove(e,t){return openModalWindow('<span class="loader_img loader_user_deldata absolute_center" title="'+evo_js_lang_loading+'"></span>',"450px","",!0,'<span class="text-danger">'+evo_js_lang_remove_user_membership+"</span>",evo_js_lang_remove,!0),jQuery.ajax({type:"POST",url:evo_js_user_org_ajax_url,data:{ctrl:"organizations",action:"remove_user",org_ID:e,user_ID:t,display_mode:"js",crumb_user:evo_js_crumb_organization},success:function(e){openModalWindow(e,"450px","",!0,'<span class="text-danger">'+evo_js_lang_remove_user_membership+"</span>",evo_js_lang_remove)}}),!1}function add_user_automation(e){return openModalWindow('<span class="loader_img loader_add_user_automation absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_add_user_to_automation,evo_js_lang_add,!0),jQuery.ajax({type:"POST",url:evo_js_user_automation_ajax_url,data:{ctrl:"user",user_tab:"automation",user_ID:e,display_mode:"js",crumb_user:evo_js_crumb_user},success:function(e){openModalWindow(e,"auto","",!0,evo_js_lang_add_user_to_automation,evo_js_lang_add)}}),!1}function add_userlist_automation(){return openModalWindow('<span class="loader_img loader_add_userlist_automation absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_add_current_selection_to_automation,evo_js_lang_add_selected_users_to_automation,!0),jQuery.ajax({type:"POST",url:evo_js_userlist_automation_ajax_url,data:{ctrl:"users",action:"automation",display_mode:"js"},success:function(e){openModalWindow(e,"auto","",!0,evo_js_lang_add_current_selection_to_automation,evo_js_lang_add_selected_users_to_automation)}}),!1}function requeue_automation(e,t,n,r,o){var i=evo_js_lang_requeue_automation_for_finished_steps;return void 0!==r?i=evo_js_lang_requeue_automation_for_user.replace("%s",o):void 0!==t&&(i=evo_js_lang_requeue_automation_for_step_users.replace("%s",n)),openModalWindow('<span class="loader_img loader_requeue_automation absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,i,evo_js_lang_requeue,!0),jQuery.ajax({type:"POST",url:evo_js_requeue_automation_ajax_url,data:{ctrl:"automations",action:"requeue_form",autm_ID:e,source_step_ID:void 0===t?0:t,source_user_ID:void 0===r?0:r,display_mode:"js"},success:function(e){openModalWindow(e,"auto","",!0,i,evo_js_lang_requeue)}}),!1}function add_remove_userlist_tags(){return openModalWindow('<span class="loader_img loader_add_userlist_automation absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_add_remove_tags_to_users,evo_js_lang_make_changes_now,!0),jQuery.ajax({type:"POST",url:evo_js_userlist_tags_ajax_url,data:{ctrl:"users",action:"edit_tags",display_mode:"js"},success:function(e){openModalWindow(e,"auto","",!0,evo_js_lang_add_remove_tags_to_users,evo_js_lang_make_changes_now)}}),!1}function set_account_status(){return openModalWindow('<span class="loader_img loader_set_user_account_status absolute_center" title="'+evo_js_lang_loading+'"></span>',"500px","",!0,evo_js_lang_set_user_account_status,evo_js_lang_make_changes_now,!0),jQuery.ajax({type:"POST",url:evo_js_userlist_set_account_status_ajax_url,data:{ctrl:"users",action:"set_status",display_mode:"js"},success:function(e){openModalWindow(e,"500px","",!0,evo_js_lang_set_user_account_status,evo_js_lang_make_changes_now)}}),!1}function change_groups(){return openModalWindow('<span class="loader_img loader_change_groups absolute_center" title="'+evo_js_lang_loading+'"></span>',"500px","",!0,evo_js_lang_change_groups,evo_js_lang_make_changes_now,!0),jQuery.ajax({type:"POST",url:evo_js_userlist_change_groups_ajax_url,data:{ctrl:"users",action:"change_groups",display_mode:"js"},success:function(e){openModalWindow(e,"500px","",!0,evo_js_lang_change_groups,evo_js_lang_make_changes_now)}}),!1}function evo_users_list_default_filters(){return openModalWindow('<span class="loader_img loader_user_filters absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_change_default_users_filters,evo_js_lang_save_defaults,!0),jQuery.ajax({type:"POST",url:evo_js_userlist_filters_ajax_url,data:{action:"get_user_default_filters_form"},success:function(e){openModalWindow(e,"auto","",!0,evo_js_lang_change_default_users_filters,evo_js_lang_save_defaults)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;"function"==typeof params_func&&(func=params_func,params={},method=func_method),void 0===method&&(method="GET"),jQuery.ajax({contentType:"application/json; charset=utf-8",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){"object"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function evo_rest_api_print_error(e,t,n){if("string"!=typeof t&&void 0===t.code&&(t=void 0===t.responseJSON?t.statusText:t.responseJSON),void 0===t.code)var r='<h4 class="text-danger">Unknown error: '+t+"</h4>";else{r='<h4 class="text-danger">'+t.message+"</h4>";n&&(r+="<div><b>Code:</b> "+t.code+"</div><div><b>Status:</b> "+t.data.status+"</div>")}evo_rest_api_end_loading(e,r)}function evo_rest_api_start_loading(e){jQuery(e).addClass("evo_rest_api_loading").append('<div class="evo_rest_api_loader">loading...</div>')}function evo_rest_api_end_loading(e,t){jQuery(e).removeClass("evo_rest_api_loading").html(t).find(".evo_rest_api_loader").remove()}function evo_link_initialize_fieldset(n){if(0<jQuery("#"+n+"attachments_fieldset_table").length){var e=jQuery("#"+n+"attachments_fieldset_table").height();e=320<e?320:e<97?97:e,jQuery("#"+n+"attachments_fieldset_wrapper").height(e),jQuery("#"+n+"attachments_fieldset_wrapper").resizable({minHeight:80,handles:"s",zIndex:0,resize:function(e,t){jQuery("#"+n+"attachments_fieldset_wrapper").resizable("option","maxHeight",jQuery("#"+n+"attachments_fieldset_table").height()),evo_link_update_overlay(n)}}),jQuery(document).on("click","#"+n+"attachments_fieldset_wrapper .ui-resizable-handle",function(){var e=jQuery("#"+n+"attachments_fieldset_table").height(),t=jQuery("#"+n+"attachments_fieldset_wrapper").height()+80;jQuery("#"+n+"attachments_fieldset_wrapper").css("height",e<t?e:t),evo_link_update_overlay(n)})}}function evo_link_update_overlay(e){jQuery("#"+e+"attachments_fieldset_overlay").length&&jQuery("#"+e+"attachments_fieldset_overlay").css("height",jQuery("#"+e+"attachments_fieldset_wrapper").closest(".panel").height())}function evo_link_fix_wrapper_height(e){var t=void 0===e?"":e,n=jQuery("#"+t+"attachments_fieldset_table").height();jQuery("#"+t+"attachments_fieldset_wrapper").height()!=n&&jQuery("#"+t+"attachments_fieldset_wrapper").height(jQuery("#"+t+"attachments_fieldset_table").height())}function evo_link_change_position(n,e,t){var r=n,o=n.value,i=n.id.substr(17);return jQuery.get(e+"anon_async.php?action=set_object_link_position&link_ID="+i+"&link_position="+o+"&crumb_link="+t,{},function(e,t){"OK"==(e=ajax_debug_clear(e))?(evoFadeSuccess(jQuery(r).closest("tr")),jQuery(r).closest("td").removeClass("error"),"cover"!=o&&"background"!=o||jQuery("select[name=link_position][id!="+n.id+"] option[value=cover]:selected").each(function(){jQuery(this).parent().val("aftermore"),evoFadeSuccess(jQuery(this).closest("tr"))})):(jQuery(r).val(e),evoFadeFailure(jQuery(r).closest("tr")),jQuery(r.form).closest("td").addClass("error"))}),!1}function evo_link_insert_inline(e,t,n,r,o,i){if(null==r&&(r=0),void 0!==i){var a="["+e+":"+t;n.length&&(a+=":"+n),a+="]",void 0!==o&&!1!==o&&(a+=o+"[/"+e+"]");var s=jQuery("#display_position_"+t);0!=s.length&&"inline"!=s.val()?(deferInlineReminder=!0,evo_rest_api_request("links/"+t+"/position/inline",function(e){s.val("inline"),evoFadeSuccess(s.closest("tr")),s.closest("td").removeClass("error"),textarea_wrap_selection(i,a,"",r,window.document)},"POST"),deferInlineReminder=!1):textarea_wrap_selection(i,a,"",r,window.document)}}function evo_link_delete(n,r,o,e){return evo_rest_api_request("links/"+o,{action:e},function(e){if("item"==r||"comment"==r||"emailcampaign"==r||"message"==r){var t=window.b2evoCanvas;if(null!=t)textarea_str_replace(t,new RegExp("\\[(image|file|inline|video|audio|thumbnail):"+o+":?[^\\]]*\\]","ig"),"",window.document)}jQuery(n).closest("tr").remove(),evo_link_fix_wrapper_height()},"DELETE"),!1}function evo_link_change_order(_,e,d){return evo_rest_api_request("links/"+e+"/"+d,function(e){var t=jQuery(_).closest("tr"),n=t.find("span[data-order]");if("move_up"==d){var r=n.attr("data-order"),o=jQuery(t.prev()).find("span[data-order]"),i=o.attr("data-order");t.prev().before(t),n.attr("data-order",i),o.attr("data-order",r)}else{r=n.attr("data-order");var a=jQuery(t.next()).find("span[data-order]"),s=a.attr("data-order");t.next().after(t),n.attr("data-order",s),a.attr("data-order",r)}evoFadeSuccess(t)},"POST"),!1}function evo_link_attach(e,t,n,r,o){return evo_rest_api_request("links",{action:"attach",type:e,object_ID:t,root:n,path:r},function(e){void 0===o&&(o="");var t=jQuery("#"+o+"attachments_fieldset_table .results table",window.parent.document),n=jQuery(e.list_content);t.replaceWith(jQuery("table",n)).promise().done(function(e){setTimeout(function(){window.parent.evo_link_fix_wrapper_height()},10)})}),!1}function evo_link_ajax_loading_overlay(e){var t=jQuery("#"+(void 0===e?"":e)+"attachments_fieldset_table"),n=!1;return 0==t.find(".results_ajax_loading").length&&(n=jQuery('<div class="results_ajax_loading"><div>&nbsp;</div></div>'),t.css("position","relative"),n.css({width:t.width(),height:t.height()}),t.append(n)),n}function evo_link_refresh_list(e,t,n,r){var o=void 0===r?"":r,i=evo_link_ajax_loading_overlay(o);return void 0===n&&(n="refresh"),i&&evo_rest_api_request("links",{action:n,type:e.toLowerCase(),object_ID:t,prefix:o},function(e){jQuery("#"+o+"attachments_fieldset_table").html(e.html),window.evo_init_dragdrop_button_config["fieldset_"+o]&&init_uploader(window.evo_init_dragdrop_button_config["fieldset_"+o]),evo_link_fix_wrapper_height(o),i.remove()}),!1}function evo_link_sort_list(e){var n,r=void 0===e?"":e,o=jQuery("#"+r+"attachments_fieldset_table tbody.filelist_tbody tr");o.sort(function(e,t){var n=parseInt(jQuery("span[data-order]",e).attr("data-order")),r=parseInt(jQuery("span[data-order]",t).attr("data-order"));return(n=n||o.length)<(r=r||o.length)?-1:r<n?1:0}),$.each(o,function(e,t){n=(0===e?jQuery(t).prependTo("#"+r+"attachments_fieldset_table tbody.filelist_tbody"):jQuery(t).insertAfter(n),t)})}jQuery(document).ready(function(){"undefined"!=typeof b2evo_widgets_init&&!1===b2evo_widgets_init||(makeDragnDrop(".draggable_widget"),jQuery(".fieldset_title").each(function(){jQuery(this).droppable({accept:".draggable_widget",hoverClass:"droppable-hover",greedy:!0,tolerance:"pointer",delay:1e3,drop:function(e,t){jQuery(".fade_me").removeClass("fade_me"),jQuery(".available_widgets").removeClass("available_widgets_active"),jQuery(t.draggable).prependTo(jQuery("#container_"+jQuery(this).find(".container_name").data("wico_id"))),jQuery(t.draggable).addClass("fade_me server_update"),jQuery(t.draggable).droppable("enable"),doFade(".fade_me"),colourWidgets(),sendWidgetOrder()}})}),jQuery(".no-drop .draggable_widget").droppable("disable"),jQuery(".draggable_widget").bind("mousedown",function(){jQuery(this).hasClass("new_widget")||jQuery(".available_widgets_active").removeClass("available_widgets_active")}),colourWidgets(),convertAvailableList(),current_widgets=getWidgetOrder(),doFade(".evo_highlight"),jQuery("#widget_button_check_all").click(function(){jQuery(this).closest("form").find("input[type=checkbox]:enabled").prop("checked",!0)}),jQuery("#widget_button_uncheck_all").click(function(){jQuery(this).closest("form").find("input[type=checkbox]").prop("checked",!1)}),jQuery("#widget_button_check_active").click(function(){jQuery(this).closest("form").find(".widget_checkbox.widget_checkbox_enabled input[type=checkbox]:enabled").prop("checked",!0),jQuery(this).closest("form").find(".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]").prop("checked",!1)}),jQuery("#widget_button_check_inactive").click(function(){jQuery(this).closest("form").find(".widget_checkbox.widget_checkbox_enabled input[type=checkbox]").prop("checked",!1),jQuery(this).closest("form").find(".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]:enabled").prop("checked",!0)}),jQuery(document).keyup(function(e){27==e.keyCode&&(closeWidgetSettings(),closeAvailableWidgets())}))}),jQuery(document).keyup(function(e){27==e.keyCode&&closeModalWindow()}),jQuery(document).ready(function(){jQuery("img.loadimg").each(function(){jQuery(this).prop("complete")?(jQuery(this).removeClass("loadimg"),""==jQuery(this).attr("class")&&jQuery(this).removeAttr("class")):jQuery(this).on("load",function(){jQuery(this).removeClass("loadimg"),""==jQuery(this).attr("class")&&jQuery(this).removeAttr("class")})})}),jQuery(document).on("click","[data-dir-path]",function(){var e=jQuery(this);if(e.hasClass("fa")||e.hasClass("glyphicon")){if(""!=e.data("toggle")){var t=e.hasClass("fa")?"fa":"glyphicon";null==e.data("toggle-orig-class")&&e.data("toggle-orig-class",e.attr("class").replace(new RegExp("^"+t+" (.+)$","g"),"$1")),e.hasClass(e.data("toggle-orig-class"))?e.removeClass(e.data("toggle-orig-class")).addClass(t+"-"+e.data("toggle")):e.removeClass(t+"-"+e.data("toggle")).addClass(e.data("toggle-orig-class"))}}else{var n=e.css("background-position").match(/-*\d+/g);e.css("background-position",parseInt(n[0])+(hide?16:-16)+"px "+parseInt(n[1])+"px")}var r=jQuery(this).parent(),o=r.next("ul");o.length?o.toggle():(r.after('<ul class="clicktree"><span class="loader_img"></span></ul>'),jQuery.ajax({type:"POST",url:htsrv_url+"async.php",data:{action:"browse_subdirs",path:jQuery(this).data("dir-path"),b2evo_icons_type:b2evo_icons_type},success:function(e){r.next("ul").html(ajax_debug_clear(e))},error:function(e){r.next("ul").html(e.responseText)}}))}),jQuery(document).on("keydown","textarea, input",function(e){!e.metaKey&&!e.ctrlKey||13!=e.keyCode&&10!=e.keyCode||jQuery(this).closest("form").submit()}),jQuery(document).ready(function(){var e="input[type=text][data-maxlength], textarea[data-maxlength], input[type=text][data-recommended-length], textarea[data-recommended-length]";function n(e){return"countdown"==r(e)?e.data("maxlength")-e.val().length:jQuery("<textarea/>").html(e.val()).text().length}function r(e){return void 0!==e.data("maxlength")?"countdown":"recommended"}function o(e){if("recommended"==r(e)){var t=e.next(".evo_input_counter");if(0!=t.length){var n=t.html();n<=e.data("recommended-min")?t.removeClass("label-warning label-danger").addClass("label label-success"):n>e.data("recommended-min")&&n<=e.data("recommended-max")?t.removeClass("label-success label-danger").addClass("label label-warning"):t.removeClass("label-success label-warning").addClass("label label-danger")}}}function i(e){var t=e.next(".evo_input_counter");if(0!=t.length){var n=(e.outerHeight(!0)-parseInt(t.outerHeight(!0)))/2,r=e.position().top+n;"TEXTAREA"==e.prop("tagName")&&(r+=n-parseInt(e.css("padding-bottom"))),t.css({top:r,left:e.position().left+e.outerWidth(!0)-t.outerWidth(!0)-e.data("padding-right")/2}),e.css("padding-right",e.data("padding-right")+t.outerWidth(!0))}}jQuery(e).each(function(){if(jQuery(this).after('<span class="evo_input_counter">'+n(jQuery(this))+"</span>"),jQuery(this).parent().css("position","relative"),jQuery(this).data("padding-right",parseInt(jQuery(this).css("padding-right"))),"recommended"==r(jQuery(this))){var e=jQuery(this).data("recommended-length").toString().split(";",2);jQuery(this).data("recommended-min",parseInt(e[0])),jQuery(this).data("recommended-max",parseInt(typeof e[1]?e[1]:e[0])),o(jQuery(this))}i(jQuery(this))}),jQuery(e).keyup(function(){var e=jQuery(this).next(".evo_input_counter");if(0!=e.length){var t=e.html().length;e.html(n(jQuery(this))),o(jQuery(this)),t!=e.html().length&&i(jQuery(this))}}),jQuery(window).resize(function(){jQuery(e).each(function(){i(jQuery(this))})})});